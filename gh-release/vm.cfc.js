"use strict";var t=require("zlib"),e=require("crypto"),n=require("path"),r=require("fs"),o=require("json5"),i=require("got");function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function s(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var c=s(e),u=s(n),f=s(r),l=s(o),d=a(i);var p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g=function(t){return t&&t.Math==Math&&t},m=g("object"==typeof globalThis&&globalThis)||g("object"==typeof window&&window)||g("object"==typeof self&&self)||g("object"==typeof p&&p)||function(){return this}()||Function("return this")(),h={},y=function(t){try{return!!t()}catch(t){return!0}},v=!y((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),_=!y((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),w=_,b=Function.prototype.call,$=w?b.bind(b):function(){return b.apply(b,arguments)},T={},S={}.propertyIsEnumerable,O=Object.getOwnPropertyDescriptor,k=O&&!S.call({1:2},1);T.f=k?function(t){var e=O(this,t);return!!e&&e.enumerable}:S;var C,I,P=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},x=_,E=Function.prototype,j=E.bind,L=E.call,A=x&&j.bind(L,L),R=x?function(t){return t&&A(t)}:function(t){return t&&function(){return L.apply(t,arguments)}},U=R,B=U({}.toString),D=U("".slice),N=function(t){return D(B(t),8,-1)},F=y,z=N,M=Object,q=R("".split),J=F((function(){return!M("z").propertyIsEnumerable(0)}))?function(t){return"String"==z(t)?q(t,""):M(t)}:M,G=TypeError,K=function(t){if(null==t)throw G("Can't call method on "+t);return t},W=J,H=K,Q=function(t){return W(H(t))},Y=function(t){return"function"==typeof t},V=Y,X=function(t){return"object"==typeof t?null!==t:V(t)},Z=m,tt=Y,et=function(t){return tt(t)?t:void 0},nt=function(t,e){return arguments.length<2?et(Z[t]):Z[t]&&Z[t][e]},rt=R({}.isPrototypeOf),ot=m,it=nt("navigator","userAgent")||"",at=ot.process,st=ot.Deno,ct=at&&at.versions||st&&st.version,ut=ct&&ct.v8;ut&&(I=(C=ut.split("."))[0]>0&&C[0]<4?1:+(C[0]+C[1])),!I&&it&&(!(C=it.match(/Edge\/(\d+)/))||C[1]>=74)&&(C=it.match(/Chrome\/(\d+)/))&&(I=+C[1]);var ft=I,lt=y,dt=!!Object.getOwnPropertySymbols&&!lt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ft&&ft<41})),pt=dt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,gt=nt,mt=Y,ht=rt,yt=Object,vt=pt?function(t){return"symbol"==typeof t}:function(t){var e=gt("Symbol");return mt(e)&&ht(e.prototype,yt(t))},_t=String,wt=function(t){try{return _t(t)}catch(t){return"Object"}},bt=Y,$t=wt,Tt=TypeError,St=function(t){if(bt(t))return t;throw Tt($t(t)+" is not a function")},Ot=St,kt=function(t,e){var n=t[e];return null==n?void 0:Ot(n)},Ct=$,It=Y,Pt=X,xt=TypeError,Et={exports:{}},jt=m,Lt=Object.defineProperty,At=function(t,e){try{Lt(jt,t,{value:e,configurable:!0,writable:!0})}catch(n){jt[t]=e}return e},Rt=At,Ut=m["__core-js_shared__"]||Rt("__core-js_shared__",{}),Bt=Ut;(Et.exports=function(t,e){return Bt[t]||(Bt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.4",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.4/LICENSE",source:"https://github.com/zloirock/core-js"});var Dt=K,Nt=Object,Ft=function(t){return Nt(Dt(t))},zt=Ft,Mt=R({}.hasOwnProperty),qt=Object.hasOwn||function(t,e){return Mt(zt(t),e)},Jt=R,Gt=0,Kt=Math.random(),Wt=Jt(1..toString),Ht=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Wt(++Gt+Kt,36)},Qt=m,Yt=Et.exports,Vt=qt,Xt=Ht,Zt=dt,te=pt,ee=Yt("wks"),ne=Qt.Symbol,re=ne&&ne.for,oe=te?ne:ne&&ne.withoutSetter||Xt,ie=function(t){if(!Vt(ee,t)||!Zt&&"string"!=typeof ee[t]){var e="Symbol."+t;Zt&&Vt(ne,t)?ee[t]=ne[t]:ee[t]=te&&re?re(e):oe(e)}return ee[t]},ae=$,se=X,ce=vt,ue=kt,fe=function(t,e){var n,r;if("string"===e&&It(n=t.toString)&&!Pt(r=Ct(n,t)))return r;if(It(n=t.valueOf)&&!Pt(r=Ct(n,t)))return r;if("string"!==e&&It(n=t.toString)&&!Pt(r=Ct(n,t)))return r;throw xt("Can't convert object to primitive value")},le=TypeError,de=ie("toPrimitive"),pe=function(t,e){if(!se(t)||ce(t))return t;var n,r=ue(t,de);if(r){if(void 0===e&&(e="default"),n=ae(r,t,e),!se(n)||ce(n))return n;throw le("Can't convert object to primitive value")}return void 0===e&&(e="number"),fe(t,e)},ge=vt,me=function(t){var e=pe(t,"string");return ge(e)?e:e+""},he=X,ye=m.document,ve=he(ye)&&he(ye.createElement),_e=function(t){return ve?ye.createElement(t):{}},we=_e,be=!v&&!y((function(){return 7!=Object.defineProperty(we("div"),"a",{get:function(){return 7}}).a})),$e=v,Te=$,Se=T,Oe=P,ke=Q,Ce=me,Ie=qt,Pe=be,xe=Object.getOwnPropertyDescriptor;h.f=$e?xe:function(t,e){if(t=ke(t),e=Ce(e),Pe)try{return xe(t,e)}catch(t){}if(Ie(t,e))return Oe(!Te(Se.f,t,e),t[e])};var Ee={},je=v&&y((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Le=X,Ae=String,Re=TypeError,Ue=function(t){if(Le(t))return t;throw Re(Ae(t)+" is not an object")},Be=v,De=be,Ne=je,Fe=Ue,ze=me,Me=TypeError,qe=Object.defineProperty,Je=Object.getOwnPropertyDescriptor;Ee.f=Be?Ne?function(t,e,n){if(Fe(t),e=ze(e),Fe(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var r=Je(t,e);r&&r.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return qe(t,e,n)}:qe:function(t,e,n){if(Fe(t),e=ze(e),Fe(n),De)try{return qe(t,e,n)}catch(t){}if("get"in n||"set"in n)throw Me("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Ge=Ee,Ke=P,We=v?function(t,e,n){return Ge.f(t,e,Ke(1,n))}:function(t,e,n){return t[e]=n,t},He={exports:{}},Qe=v,Ye=qt,Ve=Function.prototype,Xe=Qe&&Object.getOwnPropertyDescriptor,Ze=Ye(Ve,"name"),tn={EXISTS:Ze,PROPER:Ze&&"something"===function(){}.name,CONFIGURABLE:Ze&&(!Qe||Qe&&Xe(Ve,"name").configurable)},en=Y,nn=Ut,rn=R(Function.toString);en(nn.inspectSource)||(nn.inspectSource=function(t){return rn(t)});var on,an,sn,cn=nn.inspectSource,un=Y,fn=cn,ln=m.WeakMap,dn=un(ln)&&/native code/.test(fn(ln)),pn=Et.exports,gn=Ht,mn=pn("keys"),hn=function(t){return mn[t]||(mn[t]=gn(t))},yn={},vn=dn,_n=m,wn=R,bn=X,$n=We,Tn=qt,Sn=Ut,On=hn,kn=yn,Cn=_n.TypeError,In=_n.WeakMap;if(vn||Sn.state){var Pn=Sn.state||(Sn.state=new In),xn=wn(Pn.get),En=wn(Pn.has),jn=wn(Pn.set);on=function(t,e){if(En(Pn,t))throw new Cn("Object already initialized");return e.facade=t,jn(Pn,t,e),e},an=function(t){return xn(Pn,t)||{}},sn=function(t){return En(Pn,t)}}else{var Ln=On("state");kn[Ln]=!0,on=function(t,e){if(Tn(t,Ln))throw new Cn("Object already initialized");return e.facade=t,$n(t,Ln,e),e},an=function(t){return Tn(t,Ln)?t[Ln]:{}},sn=function(t){return Tn(t,Ln)}}var An={set:on,get:an,has:sn,enforce:function(t){return sn(t)?an(t):on(t,{})},getterFor:function(t){return function(e){var n;if(!bn(e)||(n=an(e)).type!==t)throw Cn("Incompatible receiver, "+t+" required");return n}}},Rn=y,Un=Y,Bn=qt,Dn=v,Nn=tn.CONFIGURABLE,Fn=cn,zn=An.enforce,Mn=An.get,qn=Object.defineProperty,Jn=Dn&&!Rn((function(){return 8!==qn((function(){}),"length",{value:8}).length})),Gn=String(String).split("String"),Kn=He.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Bn(t,"name")||Nn&&t.name!==e)&&(Dn?qn(t,"name",{value:e,configurable:!0}):t.name=e),Jn&&n&&Bn(n,"arity")&&t.length!==n.arity&&qn(t,"length",{value:n.arity});try{n&&Bn(n,"constructor")&&n.constructor?Dn&&qn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=zn(t);return Bn(r,"source")||(r.source=Gn.join("string"==typeof e?e:"")),t};Function.prototype.toString=Kn((function(){return Un(this)&&Mn(this).source||Fn(this)}),"toString");var Wn=Y,Hn=Ee,Qn=He.exports,Yn=At,Vn={},Xn=Math.ceil,Zn=Math.floor,tr=Math.trunc||function(t){var e=+t;return(e>0?Zn:Xn)(e)},er=function(t){var e=+t;return e!=e||0===e?0:tr(e)},nr=er,rr=Math.max,or=Math.min,ir=er,ar=Math.min,sr=function(t){return t>0?ar(ir(t),9007199254740991):0},cr=function(t){return sr(t.length)},ur=Q,fr=function(t,e){var n=nr(t);return n<0?rr(n+e,0):or(n,e)},lr=cr,dr=function(t){return function(e,n,r){var o,i=ur(e),a=lr(i),s=fr(r,a);if(t&&n!=n){for(;a>s;)if((o=i[s++])!=o)return!0}else for(;a>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},pr={includes:dr(!0),indexOf:dr(!1)},gr=qt,mr=Q,hr=pr.indexOf,yr=yn,vr=R([].push),_r=function(t,e){var n,r=mr(t),o=0,i=[];for(n in r)!gr(yr,n)&&gr(r,n)&&vr(i,n);for(;e.length>o;)gr(r,n=e[o++])&&(~hr(i,n)||vr(i,n));return i},wr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],br=_r,$r=wr.concat("length","prototype");Vn.f=Object.getOwnPropertyNames||function(t){return br(t,$r)};var Tr={};Tr.f=Object.getOwnPropertySymbols;var Sr=nt,Or=Vn,kr=Tr,Cr=Ue,Ir=R([].concat),Pr=Sr("Reflect","ownKeys")||function(t){var e=Or.f(Cr(t)),n=kr.f;return n?Ir(e,n(t)):e},xr=qt,Er=Pr,jr=h,Lr=Ee,Ar=function(t,e,n){for(var r=Er(e),o=Lr.f,i=jr.f,a=0;a<r.length;a++){var s=r[a];xr(t,s)||n&&xr(n,s)||o(t,s,i(e,s))}},Rr=y,Ur=Y,Br=/#|\.prototype\./,Dr=function(t,e){var n=Fr[Nr(t)];return n==Mr||n!=zr&&(Ur(e)?Rr(e):!!e)},Nr=Dr.normalize=function(t){return String(t).replace(Br,".").toLowerCase()},Fr=Dr.data={},zr=Dr.NATIVE="N",Mr=Dr.POLYFILL="P",qr=Dr,Jr=m,Gr=h.f,Kr=We,Wr=function(t,e,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:e;if(Wn(n)&&Qn(n,i,r),r.global)o?t[e]=n:Yn(e,n);else{try{r.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=n:Hn.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},Hr=At,Qr=Ar,Yr=qr,Vr=function(t,e){var n,r,o,i,a,s=t.target,c=t.global,u=t.stat;if(n=c?Jr:u?Jr[s]||Hr(s,{}):(Jr[s]||{}).prototype)for(r in e){if(i=e[r],o=t.dontCallGetSet?(a=Gr(n,r))&&a.value:n[r],!Yr(c?r:s+(u?".":"#")+r,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Qr(i,o)}(t.sham||o&&o.sham)&&Kr(i,"sham",!0),Wr(n,r,i,t)}},Xr=_,Zr=Function.prototype,to=Zr.apply,eo=Zr.call,no="object"==typeof Reflect&&Reflect.apply||(Xr?eo.bind(to):function(){return eo.apply(to,arguments)}),ro=Y,oo=String,io=TypeError,ao=R,so=Ue,co=function(t){if("object"==typeof t||ro(t))return t;throw io("Can't set "+oo(t)+" as a prototype")},uo=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=ao(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),e=n instanceof Array}catch(t){}return function(n,r){return so(n),co(r),e?t(n,r):n.__proto__=r,n}}():void 0),fo=Ee.f,lo=Y,po=X,go=uo,mo={};mo[ie("toStringTag")]="z";var ho="[object z]"===String(mo),yo=Y,vo=N,_o=ie("toStringTag"),wo=Object,bo="Arguments"==vo(function(){return arguments}()),$o=ho?vo:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=wo(t),_o))?n:bo?vo(e):"Object"==(r=vo(e))&&yo(e.callee)?"Arguments":r},To=$o,So=String,Oo=function(t){if("Symbol"===To(t))throw TypeError("Cannot convert a Symbol value to a string");return So(t)},ko=Oo,Co=function(t,e){return void 0===t?arguments.length<2?"":e:ko(t)},Io=X,Po=We,xo=function(t,e){Io(e)&&"cause"in e&&Po(t,"cause",e.cause)},Eo=Error,jo=R("".replace),Lo=String(Eo("zxcasd").stack),Ao=/\n\s*at [^:]*:[^\n]*/,Ro=Ao.test(Lo),Uo=function(t,e){if(Ro&&"string"==typeof t&&!Eo.prepareStackTrace)for(;e--;)t=jo(t,Ao,"");return t},Bo=P,Do=!y((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",Bo(1,7)),7!==t.stack)})),No=nt,Fo=qt,zo=We,Mo=rt,qo=uo,Jo=Ar,Go=function(t,e,n){n in t||fo(t,n,{configurable:!0,get:function(){return e[n]},set:function(t){e[n]=t}})},Ko=function(t,e,n){var r,o;return go&&lo(r=e.constructor)&&r!==n&&po(o=r.prototype)&&o!==n.prototype&&go(t,o),t},Wo=Co,Ho=xo,Qo=Uo,Yo=Do,Vo=v,Xo=Vr,Zo=no,ti=function(t,e,n,r){var o="stackTraceLimit",i=r?2:1,a=t.split("."),s=a[a.length-1],c=No.apply(null,a);if(c){var u=c.prototype;if(Fo(u,"cause")&&delete u.cause,!n)return c;var f=No("Error"),l=e((function(t,e){var n=Wo(r?e:t,void 0),o=r?new c(t):new c;return void 0!==n&&zo(o,"message",n),Yo&&zo(o,"stack",Qo(o.stack,2)),this&&Mo(u,this)&&Ko(o,this,l),arguments.length>i&&Ho(o,arguments[i]),o}));l.prototype=u,"Error"!==s?qo?qo(l,f):Jo(l,f,{name:!0}):Vo&&o in c&&(Go(l,c,o),Go(l,c,"prepareStackTrace")),Jo(l,c);try{u.name!==s&&zo(u,"name",s),u.constructor=l}catch(t){}return l}},ei=m.WebAssembly,ni=7!==Error("e",{cause:7}).cause,ri=function(t,e){var n={};n[t]=ti(t,e,ni),Xo({global:!0,constructor:!0,arity:1,forced:ni},n)},oi=function(t,e){if(ei&&ei[t]){var n={};n[t]=ti("WebAssembly."+t,e,ni),Xo({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:ni},n)}};function ii(e){try{const n=t.unzipSync(Buffer.from(e,"base64")).toString();try{return decodeURIComponent(ai(n))}catch(t){return unescape(n)}}catch(t){throw new Error("Error: å½åå­ç¬¦ä¸²ä¸è½è¢«Gzipè§£å")}}function ai(t){return t.replace(/\\u([\d\w]{4})/gi,((t,e)=>String.fromCodePoint(parseInt(e,16))))}ri("Error",(function(t){return function(e){return Zo(t,this,arguments)}})),ri("EvalError",(function(t){return function(e){return Zo(t,this,arguments)}})),ri("RangeError",(function(t){return function(e){return Zo(t,this,arguments)}})),ri("ReferenceError",(function(t){return function(e){return Zo(t,this,arguments)}})),ri("SyntaxError",(function(t){return function(e){return Zo(t,this,arguments)}})),ri("TypeError",(function(t){return function(e){return Zo(t,this,arguments)}})),ri("URIError",(function(t){return function(e){return Zo(t,this,arguments)}})),oi("CompileError",(function(t){return function(e){return Zo(t,this,arguments)}})),oi("LinkError",(function(t){return function(e){return Zo(t,this,arguments)}})),oi("RuntimeError",(function(t){return function(e){return Zo(t,this,arguments)}}));var si=Ee.f,ci=qt,ui=ie("toStringTag"),fi=m,li=function(t,e,n){t&&!n&&(t=t.prototype),t&&!ci(t,ui)&&si(t,ui,{configurable:!0,value:e})};Vr({global:!0},{Reflect:{}}),li(fi.Reflect,"Reflect",!0);const di=()=>Boolean(process.env.IS_QING_LONG||process.env.QL_BRANCH);function pi(){return global.IS_CFC||!0}function gi(){return global.IS_CFC||!1}function mi(){const t=di()?"cat_bili_config":"config",e=".json",{BILITOOLS_FILE_NAME:n}=process.env;return n?n.endsWith(e)?n:`${n}.json`:t+e}function hi(){const t=Object.keys(process.env),e=["securityToken","accessKeyID","accessKeySecret","FC_FUNCTION_MEMORY_SIZE","FC_FUNC_CODE_PATH","FC_RUNTIME_VERSION"];return t.filter((t=>e.includes(t))).length>=3||!1}function yi(){const t=Object.keys(process.env),e=t.filter((t=>t.startsWith("SCF_"))).length>=10,n=t.filter((t=>t.startsWith("TENCENTCLOUD_"))).length>=3;return e&&n||!1}function vi(){return yi()||hi()||gi()||pi()}const _i=["æ£","æ£å","æ£è¶","å æ²¹~","UPå æ²¹!","æ¯æ~","æ¯ææ¯æï¼","å¬æ´å¦","é¡¶é¡¶","çä¸èå°~","å¹²æ¯","bilibiliå¹²æ¯","o(*ï¿£â½ï¿£*)o","(ï½¡ï½¥âï½¥)ï¾ï¾å¨","(âËâËâ)","( â¢Ì Ï â¢Ì )y","(à¸ â¢_â¢)à¸",">.<","^_~"],wi=Object.prototype.toString;function bi(t,e){return wi.call(t)===`[object ${e}]`}function $i(t){return void 0!==t}function Ti(t){return!$i(t)}function Si(t){return null!==t&&bi(t,"Object")}function Oi(t){return null===t}function ki(t){return bi(t,"Number")}function Ci(t){return bi(t,"String")}function Ii(t){return"function"==typeof t}function Pi(t){return bi(t,"Boolean")}function xi(t){return t&&Array.isArray(t)}const Ei="undefined"==typeof window,ji=!Ei;function Li(t){const e=t||Ri(),n=e.getFullYear(),r=e.getMonth()+1;return 2===r?n%4==0&&n%100!=0||n%400==0?29:28:[4,6,9,11].includes(r)?30:31}function Ai(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=c.randomBytes(1)[0]%16;return("x"===t?e:3&e|8).toString(16)}))}function Ri(){const t=new Date,e=t.getTime(),n=t.getTimezoneOffset()/60;return new Date(e+36e5*(n+8))}function Ui(t){const e=t||Ri(),n=e.getFullYear(),r=e.getMonth()+1,o=e.getDate();return`${n}-${r<10?"0"+r:r}-${o<10?"0"+o:o}`}function Bi(t){const e=t.replace(/^\w+\(/,"").replace(/\)$/,"");return JSON.parse(e)}function Di(t,e){return Math.ceil(e/t)}function Ni(t,e,n){if(n&&"boolean"!=typeof n&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):void 0===e&&(e=t,t=0),t>e){const n=t;t=e,e=n}if(n||t%1||e%1){const n=Math.random();return Math.min(t+n*(e-t+parseFloat("1e-"+((n+"").length-1))),e)}return t+Math.floor(Math.random()*(e-t+1))}function Fi({hours:t,minutes:e,seconds:n},r){let o;switch(n=n||0,r){case"scf":default:o=`${n} ${e} ${t} * * * *`;break;case"fc":o=`${n} ${e} ${t} * * *`;break;case"cfc":o=`corn(${e} ${t} * * *)`}return{value:o,string:`${t}:${e}:${n}`}}function zi(t,e){let n="";for(let e=0;e<t;e++)n+=Hi("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return e?n.toLowerCase():n}function Mi(){return`${Ni(1,9)}${zi(10,!0)}0`}function qi(t,e){t.includes(e)||t.push(e)}function Ji(t){return t||{}}function Gi(t,e=!1){return Si(t)?Array.isArray(t)?t.map((t=>Gi(t,e))):e?Object.keys(t).reduce(((n,r)=>(n[r]=Gi(t[r],e),n)),{}):Object.assign({},t):t}function Ki(t,e){return void 0===t||void 0===e?t||e:Si(t)&&Si(e)?Array.isArray(t)&&Array.isArray(e)?t.concat(e):Object.keys(e).reduce(((n,r)=>(n[r]=Ki(t[r],e[r]),n)),t):e}function Wi(t){if(!Si(t)&&!xi(t))return t;const e=new URLSearchParams;return Array.isArray(t)||(t=Object.entries(t)),t.forEach((([t,n])=>{Si(n)?e.append(t,JSON.stringify(n)):e.append(t,String(n))})),e.toString()}function Hi(t){return t[Ni(t.length-1)]}function Qi(t,e=!1){const n=c.createHash("md5");return n.update(t),e?n.digest("hex").toUpperCase():n.digest("hex")}function Yi(t={},e={}){function n(t){return Object.keys(t).reduce(((e,n)=>(e[n.toLowerCase()]=t[n],e)),{})}return Object.assign({},n(t),n(e))}function Vi(t){return t&&t.map((t=>Number(t))).filter((t=>t>0&&t%1==0))}function Xi(){return Math.floor((new Date).getTime()/1e3)}function Zi(t,e=!0){return e?t.toLocaleString("zh-CN",{hour12:!1}):t.toLocaleString("zh-CN",{hour12:!1,hour:"numeric",minute:"numeric",second:"numeric"})}function ta(t="info"){const e=["error","warn","info","verbose","debug"],n=e.indexOf(t);return-1!==n?e.slice(0,n+1):e}function ea(t){return u.resolve(process.cwd(),t)}class na{static pushValue="";static brChar="\n";month=Ri().getMonth()+1;errorFile=ea(`./logs/bt_error-${this.month}.log`);logFile=ea(`./logs/bt_combined-${this.month}.log`);noFile=!1;constructor(t={console:"info",file:"info",push:"info"},e="default"){this.options=t,this.name=e,this.consoleLeval=ta(this.options.console),this.fileLeval=ta(this.options.file),this.pushLeval=ta(this.options.push),this.noFile=di()||vi(),this.noFile||this.createLogFile()}log({level:t},e,n){n=n||ia[t];const r=Ri(),o=["error","warn"].includes(t),i=this.options.payload?` [${this.options.payload}] `:" ";this.consoleLeval.includes(t)&&this.Conslole(`[${n} ${Zi(r,!1)}]${i}${e}\n`,o),!this.noFile&&this.fileLeval.includes(t)&&this.File(`[${n} ${Zi(r,!0)}]${i}${e}\n`,o),this.pushLeval.includes(t)&&this.Push(`[${n} ${Zi(r,!1)}] ${e}${na.brChar}`)}error(t){this.log({level:"error"},t)}warn(t){this.log({level:"warn"},t)}info(t,e){this.log({level:"info"},t,e)}verbose(t){this.log({level:"verbose"},t)}debug(t){this.log({level:"debug"},t)}Conslole(t,e){e?process.stderr.write(t):process.stdout.write(t)}File(t,e){e&&f.appendFileSync(this.errorFile,t,"utf-8"),f.appendFileSync(this.logFile,t,"utf-8")}Push(t){na.pushValue+=t}createLogFile(){const t=ea("./logs");f.existsSync(t)||f.mkdirSync(t)}static async init(){na.pushValue="";try{const{TaskConfig:t}=await Promise.resolve().then((function(){return Rs}));na.brChar=t.message.br||"\n"}catch{}}}const ra=new class{constructor(){}log(){}error(){}warn(){}info(){}verbose(){}debug(){}},oa=new na({console:"debug",file:"debug",push:"debug"}),ia={error:"â",warn:"â",info:"ð»",verbose:"ð¬",debug:"ð"};class aa{static configFileName=mi();static isQingLongPanel=di()}const sa=l.default?l.default:l;function ca(t){try{let e;if((r.existsSync(t)||r.existsSync(t+="5"))&&(e=r.readFileSync(t,"utf-8")),!e)return;return sa.parse(e)}catch(t){oa.error(t),function(t){if(!Ci(t))return;if(t.includes("SyntaxError: JSON5"))throw new SyntaxError("éç½®æä»¶å­å¨ï¼ä½æ¯æ æ³è§£æï¼å¯è½ JSON5 æ ¼å¼ä¸æ­£ç¡®ï¼");throw new Error(t)}(t.message)}}const ua=t=>u.resolve(process.cwd(),t),fa=t=>u.resolve(__dirname,"../",t),la=Array.from(new Set([ua("./config/config.dev.json"),ua(`./config/${aa.configFileName}`),ua(`./${aa.configFileName}`),fa(`./config/${aa.configFileName}`),fa(`./${aa.configFileName}`)])),da=["./config.json",ua("./config/config.json")];function pa(t){let e;const n=Array.isArray(t);if(e=n?t:t.account.filter((t=>t.cookie)),0===e.length)return;if(aa.isQingLongPanel)return function(t){const e=process.argv.find((t=>t.includes("--item")||t.includes("-i")||t.includes("-I")));if(!e)return t[0];const n=Number(e.split("=")[1])-1;return!n||n>=t.length||n<0?(oa.warn("ä¼¼ä¹æ³è¦æå®ä¸ä¸ªä¸å­å¨çç¨æ·ï¼æä»¬å°æå®ç¬¬ä¸ä¸ªç¨æ·"),t[0]):t[n]}(e);oa.warn("å¨åç¨æ·åºæ¯ä¸éç½®äºå¤ç¨æ·ï¼æä»¬å°æ¾å¼å¤ä½çéç½®");const r=e[0];return n||(r.message=Object.assign(t.message||{},r.message)),r}function ga(){if(globalThis.BILITOOLS_CONFIG)return globalThis.BILITOOLS_CONFIG;aa.isQingLongPanel&&(la.splice(0,1),la.push(...da));for(let t=0;t<la.length;t++){const e=ca(la[t]);if(e)return oa.verbose(`è¯»åéç½®æä»¶ ${la[t]}`),e}return(()=>{const{BILITOOLS_CONFIG:t,BILI_SCF_CONFIG:e,BILI_CONFIG:n}=process.env,r=t||e||n;if(r)try{return sa.parse(ii(r.trim()))}catch(t){throw oa.error(t),new Error("ç¯å¢ä¸­çéç½®ä¸æ¯ææç JSON å­ç¬¦ä¸²ï¼")}})()}function ma(t){return function(t,e=!1){if(!t)throw new Error("è·åéç½®å¤±è´¥ï¼æªæ¾å°éç½®æä»¶ï¼");if(e)return function(t){const e=t=>t.cookie&&t.cookie.length>90&&["bili_jct","SESSDATA","DedeUserID"].every((e=>t.cookie.includes(e)));if(Array.isArray(t))return t.filter(e);return t.account.filter(e)}(ha(t)?t:[t]);if(ha(t)){const e=pa(t);if(e)return e}if(!t.cookie)throw new Error("éç½®æä»¶ä¸­æ²¡æ cookieï¼");return t}(ga(),t)}function ha(t){return!!Array.isArray(t)||Boolean(t.account&&t.account.length)}var ya=X,va=N,_a=ie("match"),wa=Ue,ba=$,$a=qt,Ta=rt,Sa=function(){var t=wa(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},Oa=RegExp.prototype,ka=R,Ca=Ft,Ia=Math.floor,Pa=ka("".charAt),xa=ka("".replace),Ea=ka("".slice),ja=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,La=/\$([$&'`]|\d{1,2})/g,Aa=Vr,Ra=$,Ua=R,Ba=K,Da=Y,Na=function(t){var e;return ya(t)&&(void 0!==(e=t[_a])?!!e:"RegExp"==va(t))},Fa=Oo,za=kt,Ma=function(t){var e=t.flags;return void 0!==e||"flags"in Oa||$a(t,"flags")||!Ta(Oa,t)?e:ba(Sa,t)},qa=function(t,e,n,r,o,i){var a=n+t.length,s=r.length,c=La;return void 0!==o&&(o=Ca(o),c=ja),xa(i,c,(function(i,c){var u;switch(Pa(c,0)){case"$":return"$";case"&":return t;case"`":return Ea(e,0,n);case"'":return Ea(e,a);case"<":u=o[Ea(c,1,-1)];break;default:var f=+c;if(0===f)return i;if(f>s){var l=Ia(f/10);return 0===l?i:l<=s?void 0===r[l-1]?Pa(c,1):r[l-1]+Pa(c,1):i}u=r[f-1]}return void 0===u?"":u}))},Ja=ie("replace"),Ga=TypeError,Ka=Ua("".indexOf);Ua("".replace);var Wa,Ha=Ua("".slice),Qa=Math.max,Ya=function(t,e,n){return n>t.length?-1:""===e?n:Ka(t,e,n)};function Va(t){return t?t.match(/([^;=]+)(?:=([^;]*))?/g).reduce(((t,e)=>{const[n,r]=e.trim().split("=");return t[n]=r,t}),{}):{}}function Xa(t){let e="";return t.forEach((t=>e+=t.split("; ")[0]+"; ")),e.endsWith("; ")&&(e=e.substring(0,e.length-2||0)),e}function Za(t){const e=Va(t);var n;return e.SESSDATA=(n=e.SESSDATA,encodeURIComponent(n).replaceAll("%7C","|").replaceAll("%2B","+").replaceAll("%25","%").replaceAll("*","%2A")),ts(e)}function ts(t){const e=Object.keys(t).reduce(((e,n)=>e+`${n}=${t[n]}; `),"");return e.substring(0,e.length-2||0)}function es(t,e){return t||""===t?(Ci(e)&&(e=[e]),e&&0!==e.length?ts({...Va(t),...Va(Xa(e))}):t):""}function ns(t,e){if(!t)return null;const n=`(?:^|)${e}=([^;]*)(?:;|$)`,r=t.match(n);return r?r[1]:null}function rs(t){return Number(ns(t,"DedeUserID"))||0}function os(t){return ns(t,"bili_jct")||""}Aa({target:"String",proto:!0},{replaceAll:function(t,e){var n,r,o,i,a,s,c,u,f=Ba(this),l=0,d=0,p="";if(null!=t){if(Na(t)&&(n=Fa(Ba(Ma(t))),!~Ka(n,"g")))throw Ga("`.replaceAll` does not allow non-global regexes");if(r=za(t,Ja))return Ra(r,t,f,e)}for(o=Fa(f),i=Fa(t),(a=Da(e))||(e=Fa(e)),s=i.length,c=Qa(1,s),l=Ya(o,i,0);-1!==l;)u=a?Fa(e(i,l,o)):qa(i,o,l,[],void 0,e),p+=Ha(o,d,l)+u,d=l+s,l=Ya(o,i,l+c);return d<o.length&&(p+=Ha(o,d)),p}});class is{constructor(t){this.cookie=t}getCookieString(){return this.cookie}setCookie(t){this.cookie=es(this.cookie,t)}toJSON(){return Va(this.cookie)}getCookieItem(t){return ns(this.cookie,t)}}class as{async getCookieString(){return js.cookie}async setCookie(t){js.cookie=es(js.cookie,t)}}const ss={cookie:"",accessKey:"",message:{br:"\n",email:{host:"smtp.163.com",port:465},pushplusToken:null===(Wa=process.env.PUSHPLUS_TOKEN)||void 0===Wa?void 0:Wa.trim(),api:{method:"POST",headers:{"Content-Type":"application/json"},timeout:5e3,url:"",proxy:{host:"",port:443,auth:""},data:{}}},function:{silver2Coin:!0,liveSignTask:!0,addCoins:!0,mangaSign:!1,shareAndWatch:!0,supGroupSign:!1,liveSendMessage:!1,taskReward:!0,charging:!1,getVipPrivilege:!1,giveGift:!1,matchGame:!1,liveLottery:!1,liveRedPack:!1,batchUnfollow:!1,liveIntimacy:!1,mangaTask:!1,bigPoint:!1,liveFamine:!1},apiDelay:[2,6],userAgent:"",dailyRunTime:"17:30:00-23:40:00",targetLevel:void 0,stayCoins:void 0,targetCoins:void 0,customizeUp:void 0,giftUp:void 0,coinRetryNum:void 0,chargeUpId:void 0,chargePresetTime:void 0,matchCoins:void 0,matchSelection:void 0,matchDiff:void 0,match:{coins:5,selection:1,diff:0},charge:{mid:0,presetTime:[10,20]},gift:{mids:[]},coin:{customizeUp:[],targetLevel:6,stayCoins:0,targetCoins:5,todayCoins:0},sls:{name:"",description:"",region:"ap-chengdu",dailyRunTime:"17:30:00-23:40:00"},lottery:{excludeAward:["è°","è¹","èªæµ·","ä»£éå¸","ä¼æ å¸","èªæ","ç§","åç","å¾","æç£","è½¦è½¦ä¸å±","åæ¥ä¸å±","æ¸¸æéå·"],includeAward:["è°¢"],blackUid:[65566781,1277481241,1643654862,603676925],isMoveTag:!0,moveTag:"å¤©éæ¶å»",pageNum:2,actFollowMsg:"read",scanFollow:void 0,skipNeedFollow:!1},redPack:{},intimacy:{liveSendMessage:!0,liveShare:!0,liveLike:!0,liveHeart:!1,whiteList:[],blackList:[]},manga:{sign:!0,buy:!1,mc:[],name:[],love:!0,buyInterval:6,buyWeek:[3]},activity:{liveFamineTime:400},BILIJCT:"",USERID:0};function cs(t){return function(t){!function(t){t.BILIJCT=os(t.cookie),t.USERID=rs(t.cookie)}(t);const{coin:e,gift:n,charge:r,match:o}=t;xi(t.apiDelay)?t.apiDelay=Vi(t.apiDelay):t.apiDelay=[Number(t.apiDelay)];e.customizeUp=Vi(e.customizeUp),n.mids=Vi(n.mids),0===n.mids.length&&(n.mids=e.customizeUp);r.mid||(r.mid=t.USERID);e.targetCoins>5&&(e.targetCoins=5);o.coins>10&&(o.coins=10);return t}(function(t){return Object.keys(us).forEach((e=>{if(void 0!==t[e]){const[n,r]=us[e];t[n]=Ji(t[n]),t[n][r]=t[e]}delete t[e]})),t}(Ki(Gi(ss,!0),function(t){const{message:e}=t;if(e&&Ci(e.api)){const t=e.api;e.api=Gi(ss.message.api,!0),e.api.url=t,e.api.method="GET"}return t}(t))))}const us={targetLevel:["coin","targetLevel"],stayCoins:["coin","stayCoins"],targetCoins:["coin","targetCoins"],customizeUp:["coin","customizeUp"],coinRetryNum:["coin","retryNum"],giftUp:["gift","mids"],chargeUpId:["charge","mid"],chargePresetTime:["charge","presetTime"],matchCoins:["match","coins"],matchSelection:["match","selection"],matchDiff:["match","diff"]};const fs="https://account.bilibili.com",ls="https://live.bilibili.com",ds="https://space.bilibili.com",ps="https://message.bilibili.com",gs="https://www.bilibili.com",ms="https://www.bilibili.com/",hs="https://big.bilibili.com/mobile/bigPoint",ys="https://big.bilibili.com/mobile/bigPoint/task",vs="https://account.bilibili.com",_s="https://api.live.bilibili.com",ws="https://api.bilibili.com",bs="https://manga.bilibili.com",$s="https://api.vc.bilibili.com",Ts="https://live-trace.bilibili.com",Ss={"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.41 Safari/537.36 Edg/101.0.1210.32","content-type":"application/x-www-form-urlencoded; charset=UTF-8","accept-language":"zh-CN,zh;q=0.9","accept-encoding":"gzip, deflate, br"};function Os({version:t="6.78.0",phone:e="MI 10 Pro",build:n="6780300",channel:r="xiaomi",os:o="10"}={}){return`Mozilla/5.0 BiliDroid/${t} (bbcallen@gmail.com) os/android model/${e} mobi_app/android build/${n} channel/${r} innerVer/${r} osVer/${o} network/2`}function ks(t={},e,n){return function(t,e="1d8b6e7d45233436",n="560c52ccd288fed045859ed18bffd973"){if(t={...t,platform:"android",mobi_app:"android",disable_rcmd:0,build:6780300,c_locale:"zh_CN",s_locale:"zh_CN",ts:Xi()},!js.accessKey&&!t.access_key)return Cs(t,n,!0);return delete t.csrf,delete t.csrf_token,Cs(t={access_key:js.accessKey,...t,actionKey:"appkey",appkey:e},n)}(t,e,n).query}function Cs(t,e,n=!1){const r=Wi(function(t){return Object.keys(t).sort().map((e=>[e,t[e]]))}(t));if(n)return{query:r,sign:""};const o=Qi(r+e);return{query:r+"&sign="+o,sign:o}}function Is(t){return Object.keys(t).forEach((e=>{ki(t[e])?t[e]=t[e].toString():Si(t[e])?Is(t[e]):xi(t[e])&&(t[e]=t[e].map((t=>Si(t)?Is(t):t.toString())))})),t}function Ps(t){let e=JSON.stringify(Is(t));const n=["SHA512","SHA3-512","SHA384","SHA3-384","BLAKE2b512"];for(const t of n)e=c.createHash(t).update(e).digest("hex");return e}function xs(){return`XY${c.randomBytes(16).toString("hex").toUpperCase()}`}let Es;const js=new Proxy({},{get:(t,e)=>(Es||As(),Reflect.get(Es,e)),set:(t,e,n)=>"config"===e&&n?(As(n),!0):Reflect.set(Es,e,n)});let Ls=null;function As(t){t||(t=ma(!1));const e=cs(t),n=xs();Es={...e,mobileUA:Os(),cookie:Za(`${e.cookie}; Buvid=${n}`),buvid:n},Ls=class extends class{static money=0;static coinsTask=5;static share=!1;static watch=!1;static currentStartFun=0;static bCoinCouponBalance=0;static vipType=0;static vipStatus=0;static userLevel=0}{},Ls.coinsTask=Es.coin.targetCoins}var Rs=Object.freeze({__proto__:null,TaskConfig:js,get TaskModule(){return Ls},initialize:As,changeConfig:function(t){const e=ma();e[t]&&As(e[t])}});function Us(t,e){const n=Ds(t,e);return new Promise((t=>{setTimeout((()=>{t(n)}),n)}))}function Bs(t,e){Ds(t,e)}function Ds(t,e){if(t&&e)return Ni(t,e);if(t)return t;const n=js.apiDelay;return 1===n.length?1e3*n[0]:1e3*Ni(n[0]||2,n[1]||6)}var Ns=Object.freeze({__proto__:null,gzipEncode:function(e){try{return t.gzipSync(encodeURIComponent(e)).toString("base64")}catch(t){return"Error: å½åå­ç¬¦ä¸²ä¸è½è¢«Gzipåç¼©"}},gzipDecode:ii,unicode2str:ai,apiDelay:Us,apiDelaySync:Bs,encodeCookie:Za,getCookie:es,getCookieItem:ns,getUserId:rs,getBiliJct:os,getLIVE_BUVID:function(t){return ns(t,"LIVE_BUVID")||""},CookieJar:is,BiliCookieJar:as,isQingLongPanel:di,isCFC:pi,isAGC:gi,setConfigFileName:mi,isFC:hi,isSCF:yi,isServerless:vi,Logger:na,emptyLogger:ra,logger:oa,getMonthHasDays:Li,createUUID:Ai,getPRCDate:Ri,getDateString:Ui,jsonp2Object:Bi,getPageNum:Di,setCron:function(t=6e4,e){t=t||6e4;const n=Ri().getTime()+t,r=new Date(n),o=r.getSeconds(),i=r.getMinutes();return Fi({hours:r.getHours(),minutes:i,seconds:o},e)},random:Ni,randomDailyRunTime:function(t="17:30:00-23:40:00",e){var n,r;const o=t.split("-"),i=o[0].split(":").map((t=>+t)),a=o[1].split(":").map((t=>+t)),s=Ni(null!==(n=i[0])&&void 0!==n?n:19,null!==(r=a[0])&&void 0!==r?r:23);let c=0;c=s==i[0]?Ni(i[1],59):s==a[0]?Ni(a[1]):Ni(59);let u=0;return u=s==i[0]?Ni(i[2],59):s==a[0]?Ni(a[2]):Ni(59),Fi({seconds:u,hours:s,minutes:c},e)},formatCron:Fi,randomString:zi,getVisitId:Mi,pushIfNotExist:qi,getNewObject:Ji,cloneObject:Gi,deepMergeObject:Ki,stringify:Wi,getRandomItem:Hi,md5:Qi,mergeHeaders:Yi,arr2numArr:Vi,base64Encode:function(t){return Buffer.from(t).toString("base64")},isTodayInTimeArr:function(t){if(!t||!t.length)return!0;const e=(new Date).getDate();return t.includes(e)},getUnixTime:Xi,is:bi,isDef:$i,isUnDef:Ti,isObject:Si,isEmpty:function(t){return xi(t)||Ci(t)?0===t.length:t instanceof Map||t instanceof Set?0===t.size:!!Si(t)&&0===Object.keys(t).length},isDate:function(t){return bi(t,"Date")},isNull:Oi,isNullAndUnDef:function(t){return Ti(t)&&Oi(t)},isNullOrUnDef:function(t){return Ti(t)||Oi(t)},isNumber:ki,isPromise:function(t){return bi(t,"Promise")&&Si(t)&&Ii(t.then)&&Ii(t.catch)},isString:Ci,isFunction:Ii,isBoolean:Pi,isRegExp:function(t){return bi(t,"RegExp")},isArray:xi,isWindow:function(t){return"undefined"!=typeof window&&bi(t,"Window")},isElement:function(t){return Si(t)&&!!t.tagName},isMap:function(t){return bi(t,"Map")},isServer:Ei,isClient:ji,isUrl:function(t){return/(((^https?:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+(?::\d+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/.test(t)},isEmail:function(t){return/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(t)}});oa.info("å¼å§æ§è¡ç½ç»ä»£ç "),async function(t,...e){const{getBiliTask:n}=await Promise.resolve().then((function(){return Ms})),{apiDelay:r,logger:o,Logger:i}=await Promise.resolve().then((function(){return Ns})),{getWaitRuningFunc:a}=await Promise.resolve().then((function(){return qs})),{sendMessage:s}=await Promise.resolve().then((function(){return uc})),{printVersion:c}=await Promise.resolve().then((function(){return tf}));await i.init(),await c();try{const t=await n("loginTask");await t()}catch(t){return o.error(`ç»å½å¤±è´¥: ${t}`),await s("ç»å½å¤±è´¥",i.pushValue),"æªå®æ"}const u=a();for await(const t of u)try{await t()}catch(e){o.error(`${t.name}å¤±è´¥: ${e}`)}finally{await r()}return t&&await t(...e),await s("æ¯æ¥å®æ",i.pushValue),"å®æ"}().then((t=>{VMThis.message=t,VMThis.resolve(t)})).catch((t=>{VMThis.error=t,VMThis.reject(t)}));const Fs=["taskReward","liveSignTask","addCoins","bigPoint","shareAndWatch","silver2Coin","mangaSign","mangaTask","supGroupSign","liveSendMessage","charging","getVipPrivilege","matchGame","batchUnfollow","liveLottery","liveRedPack","liveIntimacy","giveGift","loginTask","liveFamine"],zs=[()=>Promise.resolve().then((function(){return Pf})),()=>Promise.resolve().then((function(){return Lf})),()=>Promise.resolve().then((function(){return Rf})),()=>Promise.resolve().then((function(){return al})),()=>Promise.resolve().then((function(){return sl})),()=>Promise.resolve().then((function(){return cl})),()=>Promise.resolve().then((function(){return _l})),()=>Promise.resolve().then((function(){return wl})),()=>Promise.resolve().then((function(){return Tl})),()=>Promise.resolve().then((function(){return Jl})),()=>Promise.resolve().then((function(){return Kl})),()=>Promise.resolve().then((function(){return Yl})),()=>Promise.resolve().then((function(){return Zl})),()=>Promise.resolve().then((function(){return sd})),()=>Promise.resolve().then((function(){return Pd})),()=>Promise.resolve().then((function(){return Ad})),()=>Promise.resolve().then((function(){return Rd})),()=>Promise.resolve().then((function(){return Nd})),()=>Promise.resolve().then((function(){return qd})),()=>Promise.resolve().then((function(){return Hd}))];var Ms=Object.freeze({__proto__:null,taskExportOrder:Fs,biliTasks:zs,getBiliTask:async function(t){const e=Fs.findIndex((e=>e===t));return-1===e?()=>Promise.resolve():(await zs[e]()).default},default:zs});var qs=Object.freeze({__proto__:null,getWaitRuningFunc:function(){const t=function(){const t=js.function;return t.addCoins||t.shareAndWatch||(t.taskReward=!1),t.liveIntimacy&&js.intimacy.liveSendMessage&&(t.liveSendMessage=!1),t.mangaTask&&js.manga.sign&&(t.mangaSign=!1),t}(),e=[];return Fs.forEach(((n,r)=>{t[n]&&e.push(zs[r])})),e.map((async t=>(await t()).default))}});const Js=(t,e)=>{const{isTransformResponse:n,isReturnNativeResponse:r}=e;if(r)return t;if(!1===n)return t.body;const{body:o}=t;if(e.isJsonp&&Ci(o))return Bi(o);try{if(Ci(o)&&o.startsWith("{"))return JSON.parse(o)}catch{}return o};class Gs{name="VGot";constructor(t){t.baseURL&&(t.prefixUrl=t.baseURL),this.options=t;const{withBiliCookie:e,withCredentials:n}=this.options.requestOptions;e?this.cookieJar=new as:n&&(this.cookieJar=new is),this.gotInstance=d.default.extend(t,{cookieJar:this.cookieJar})}request(t){const{requestOptions:e={},headers:n={}}=this.options;return t.requestOptions=Object.assign({},e,t.requestOptions),t.headers=Yi(n,t.headers),e.retry&&(t.retry=e.retry),t=function(t){Ci(t.url)||(t.url=t.url.toString()),Si(t.params)&&!Ci(t.searchParams)&&(t.searchParams={...t.searchParams,...t.params});const e=t.headers["content-type"],n=null==e?void 0:e.startsWith("application/x-www-form-urlencoded");function r(e){t.agent||(t.agent={}),t.agent[e]=t[`${e}Agent`]}return Si(t.data)&&(n?t.body=Wi(t.data):t.json=t.data),Ci(t.data)&&n&&(t.body=t.data),t.httpAgent&&r("http"),t.httpsAgent&&r("https"),t.url&&t.url.startsWith("/")&&(t.url=t.url.substring(1)),t}(t),new Promise(((e,n)=>{this.gotInstance(t).then((r=>{if(Ii(Js))try{const n=Js(r,t.requestOptions);e(n)}catch(t){n(t||new Error("è¯·æ±éè¯¯!"))}else e(r)})).catch((t=>{t.response&&(t.response.status=t.response.statusCode),n(t)}))}))}get(t,e){return Ci(t)?this.request({...e,method:"GET",url:t}):this.request({...t,method:"GET"})}post(t,e,n){return Ci(t)?this.request({...n,method:"POST",url:t,data:e}):this.request({...t,method:"POST"})}put(t,e,n){return this.request({...n,method:"PUT",url:t,data:e})}delete(t,e,n){return this.request({...n,method:"DELETE",url:t,data:e})}patch(t,e,n){return this.request({...n,method:"PATCH",url:t,data:e})}}function Ks(t){return new Gs(Ki({timeout:1e4,headers:{"content-type":Ss["content-type"],"user-agent":Ss["user-agent"],"accept-language":Ss["accept-language"],"accept-encoding":Ss["accept-encoding"]},requestOptions:{isTransformResponse:!0,ignoreCancelToken:!0,withBiliCookie:!0}},t||{}))}const Ws=Ks({requestOptions:{withBiliCookie:!1}}),Hs=Ks();let Qs={};function Ys(){var t;const e=js.message||{};Qs=function(t={}){return Qs.SCKEY="",Qs.BARK_PUSH="",Qs.BARK_SOUND="",Qs.BARK_GROUP="QingLong",Qs.TG_BOT_TOKEN="",Qs.TG_USER_ID="",Qs.TG_PROXY_HOST="",Qs.TG_PROXY_PORT="",Qs.TG_PROXY_AUTH="",Qs.TG_API_HOST="api.telegram.org",Qs.DD_BOT_TOKEN="",Qs.DD_BOT_SECRET="",Qs.QYWX_KEY="",Qs.QYWX_AM="",Qs.IGOT_PUSH_KEY="",Qs.PUSH_PLUS_TOKEN="",Qs.PUSH_PLUS_USER="",Qs.QQ_SKEY="",Qs.QQ_MODE="",t}(Qs),["GOBOT_URL","GOBOT_TOKEN","GOBOT_QQ","SCKEY","QQ_SKEY","QQ_MODE","BARK_PUSH","BARK_SOUND","BARK_GROUP","TG_BOT_TOKEN","TG_USER_ID","TG_PROXY_AUTH","TG_PROXY_HOST","TG_PROXY_PORT","TG_API_HOST","DD_BOT_TOKEN","DD_BOT_SECRET","QYWX_KEY","QYWX_AM","IGOT_PUSH_KEY","PUSH_PLUS_TOKEN","PUSH_PLUS_USER"].forEach((t=>{const n=e[(r=t,r.toLowerCase().replace(/_(\w)/g,((t,e)=>e.toUpperCase())))]||e[t]||process.env[t];var r,o;n&&(Qs[t]=null===(o=n.trim)||void 0===o?void 0:o.call(n))})),null!==(t=js.message)&&void 0!==t&&t.pushplusToken&&(Qs.PUSH_PLUS_TOKEN=js.message.pushplusToken)}async function Vs(t,e){var n;const r=null===(n=js.message)||void 0===n?void 0:n.email;if(!(r&&r.pass&&r.from&&r.host))return;const{createTransport:o}=await Promise.resolve().then((function(){return s(require("nodemailer"))})),i=Number(r.port)||465,a=o({host:r.host,port:i,secure:465===i,auth:{user:r.from,pass:r.pass}}),c=await a.sendMail({from:`${t} <${r.from}>`,to:r.to,subject:t,headers:{"Content-Type":"text/plain; charset=utf-8"},text:e.replace(/\n/g,"\r\n")});oa.info(`é®ä»¶æ¶æ¯å·²åé: ${c.messageId}`)}async function Xs(t,e){try{const n=js.message.api;if(!n||!n.url)return;const{data:r,proxy:o,timeout:i,headers:a}=n,c={method:n.method.toUpperCase()||"POST",timeout:i,headers:a,url:""};if(c.url=n.url.replace("{title}",encodeURIComponent(t)).replace("{text}",encodeURIComponent(e)),o.host){const t=(await Promise.resolve().then((function(){return s(require("tunnel"))}))).httpsOverHttp({proxy:{host:o.host,port:+o.port,proxyAuth:o.auth},maxSockets:1});Object.assign(c,{httpsAgent:t})}const u=Object.keys(r);u.length&&(u.forEach((n=>{"{text}"===r[n]&&(r[n]=e),"{title}"===r[n]&&(r[n]=t)})),Object.assign(c,{data:r})),await Ws.request(c),oa.info("èªå®ä¹æ¥å£æ¶æ¯å·²åéï¼")}catch(t){oa.info(`èªå®ä¹æ¥å£æ¶æ¯åéå¤±è´¥: ${t}`),oa.error(t)}}function Zs(t,e,n=2100){return new Promise((r=>{const o=Qs.SCKEY;if(o){e=e.replace(/[\n\r]/g,"\n\n");const i={url:o.includes("SCT")?`https://sctapi.ftqq.com/${o}.send`:`https://sc.ftqq.com/${o}.send`,data:`text=${t}&desp=${e}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};setTimeout((()=>{Ws.post(i).then((t=>{0===t.errno||0===t.data.errno?oa.info("serveré±åééç¥æ¶æ¯æåð"):1024===t.errno?oa.info(`serveré±åééç¥æ¶æ¯å¼å¸¸: ${t.errmsg}`):oa.info(`serveré±åééç¥æ¶æ¯å¼å¸¸\n${JSON.stringify(t)}`)})).catch((t=>{oa.info("serveré±åééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),oa.info(t)})).finally((()=>{r("")}))}),n)}else r("")}))}function tc(t,e){return new Promise((n=>{const{QQ_SKEY:r,QQ_MODE:o}=Qs;if(r){const i={url:`https://push.xuthus.cc/${o}/${r}`,headers:{"Content-Type":"application/json"},data:{},params:{}};t=t.replace(/äº¬è±/g,"è±è±"),e=(e=(e=e.replace(/äº¬è±/g,"")).replace(/ð¶/g,"")).replace(/çº¢å/g,"Hå"),i.data="email"===o?{t:t,c:e}:`${t}\n\n${e}`;const a=function(t){switch(t){case"send":return"ä¸ªäºº";case"group":return"QQç¾¤";case"wx":return"å¾®ä¿¡";case"ww":return"ä¼ä¸å¾®ä¿¡";case"email":return"é®ä»¶";default:return"æªç¥æ¹å¼"}};Ws.post(i).then((t=>{200===t.code?oa.info(`é·æ¨åé${a(o)}éç¥æ¶æ¯æåð`):400===t.code?oa.info(`QQé·æ¨(Cool Push)åé${a(o)}æ¨éå¤±è´¥ï¼${t.msg}`):503===t.code?oa.info(`QQé·æ¨åºéï¼${t.message}ï¼${t.data}`):oa.info(`é·æ¨æ¨éå¼å¸¸: ${JSON.stringify(t)}`)})).catch((t=>{oa.info(`åé${a(o)}éç¥è°ç¨APIå¤±è´¥ï¼ï¼`),oa.info(t)})).finally((()=>{n("")}))}else n("")}))}function ec(t,e,n={}){return new Promise((r=>{const{BARK_PUSH:o,BARK_SOUND:i,BARK_GROUP:a}=Qs;if(o){const s={url:`${o}/${encodeURIComponent(t)}/${encodeURIComponent(e)}?sound=${i}&group=${a}&${Wi(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};Ws.get(s).then((t=>{200===t.code?oa.info("Bark APPåééç¥æ¶æ¯æåð"):oa.info(`Bark APPåééå¤±è´¥ï¼${t.message}`)})).catch((t=>{oa.info("Bark APPåééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),oa.error(t)})).finally((()=>{r("")}))}r("")}))}function nc(t,e){return new Promise((async n=>{const{TG_BOT_TOKEN:r,TG_USER_ID:o,TG_API_HOST:i,TG_PROXY_HOST:a,TG_PROXY_PORT:c,TG_PROXY_AUTH:u}=Qs;if(r&&o){const f={url:`https://${i}/bot${r}/sendMessage`,data:`chat_id=${o}&text=${t}\n\n${e}&disable_web_page_preview=true`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};if(a&&c){const t=(await Promise.resolve().then((function(){return s(require("tunnel"))}))).httpsOverHttp({proxy:{host:a,port:+c,proxyAuth:u},maxSockets:1});Object.assign(f,{httpsAgent:t})}Ws.post(f).then((t=>{t.ok?oa.info("Telegramåééç¥æ¶æ¯æåðã"):400===t.error_code?oa.info("è¯·ä¸»å¨ç»botåéä¸æ¡æ¶æ¯å¹¶æ£æ¥æ¥æ¶ç¨æ·IDæ¯å¦æ­£ç¡®ã"):401===t.error_code&&oa.info("Telegram bot token å¡«åéè¯¯ã")})).catch((t=>{oa.info("telegramåééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),oa.info(t)})).finally((()=>{n("")}))}else n("")}))}function rc(t,e){return new Promise((n=>{const{DD_BOT_TOKEN:r,DD_BOT_SECRET:o}=Qs,i={url:`https://oapi.dingtalk.com/robot/send?access_token=${r}`,data:{msgtype:"text",text:{content:` ${t}\n\n${e}`}},headers:{"Content-Type":"application/json"},timeout:15e3};if(r){if(o){const t=require("crypto"),e=Date.now(),n=t.createHmac("sha256",o);n.update(`${e}\n${o}`);const r=encodeURIComponent(n.digest("base64"));i.url=`${i.url}&timestamp=${e}&sign=${r}`}Ws.post(i).then((t=>{0===t.errcode?oa.info("ééåééç¥æ¶æ¯æåðã"):oa.info(`ééåééç¥å¤±è´¥ï¼${t.errmsg}`)})).catch((t=>{oa.info("ééåééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),oa.info(t)})),n("")}else n("")}))}function oc(t,e){return new Promise((n=>{const{QYWX_KEY:r}=Qs,o={url:`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=${r}`,data:{msgtype:"text",text:{content:` ${t}\n\n${e}`}},headers:{"Content-Type":"application/json"},timeout:15e3};r&&Ws.post(o).then((t=>{0===t.errcode?oa.info("ä¼ä¸å¾®ä¿¡åééç¥æ¶æ¯æåðã"):oa.info(`ä¼ä¸å¾®ä¿¡åééç¥å¤±è´¥ï¼${t.errmsg}`)})).catch((t=>{oa.info("ä¼ä¸å¾®ä¿¡åééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),oa.info(t)})).finally((()=>{n("")})),n("")}))}function ic(t){const{QYWX_AM:e}=Qs,n=null==e?void 0:e.split(",");if(n[2]){const e=n[2].split("|");let r="";for(let n=0;n<e.length;n++){const o="ç­¾å°å· "+(n+1);t.match(o)&&(r=e[n])}return r||(r=n[2]),r}return"@all"}function ac(t,e){return new Promise((n=>{const r=Qs.QYWX_AM;if(r){const o=r.split(","),i={url:"https://qyapi.weixin.qq.com/cgi-bin/gettoken",data:{corpid:`${o[0]}`,corpsecret:`${o[1]}`},headers:{"Content-Type":"application/json"},timeout:15e3};Ws.post(i).then((r=>{const i=e.replace(/\n/g,"<br/>"),a=JSON.parse(r).access_token;let s;switch(o[4]){case"0":s={msgtype:"textcard",textcard:{title:`${t}`,description:`${e}`,url:"https://github.com/whyour/qinglong",btntxt:"æ´å¤"}};break;case"1":s={msgtype:"text",text:{content:`${t}\n\n${e}`}};break;default:s={msgtype:"mpnews",mpnews:{articles:[{title:`${t}`,thumb_media_id:`${o[4]}`,author:"æºè½å©æ",content_source_url:"",content:`${i}`,digest:`${e}`}]}}}o[4]||(s={msgtype:"text",text:{content:`${t}\n\n${e}`}}),s={url:`https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=${a}`,data:{touser:`${ic(e)}`,agentid:`${o[3]}`,safe:"0",...s},headers:{"Content-Type":"application/json"}},Ws.post(s).then((t=>{0===t.errcode?oa.info("æåID:"+ic(e)+"ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯æåðã"):oa.info(`ä¼ä¸å¾®ä¿¡åºç¨ï¼${t.errmsg}`)})).catch((t=>{oa.info("æåID:"+ic(e)+"ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯å¤±è´¥ï¼ï¼"),oa.info(t)})).finally((()=>{n("")}))})).catch((t=>{oa.error("ä¼ä¸å¾®ä¿¡åºç¨æ¶æ¯åééç¥æ¶æ¯å¤±è´¥ï¼ï¼")}))}else n("")}))}function sc(t,e,n={}){return new Promise((r=>{const{IGOT_PUSH_KEY:o}=Qs;if(o){if(!new RegExp("^[a-zA-Z0-9]{24}$").test(o))return oa.info("æ¨ææä¾çIGOT_PUSH_KEYæ æ"),void r("");const i={url:`https://push.hellyw.com/${o.toLowerCase()}`,data:`title=${t}&content=${e}&${Wi(n)}`,headers:{"Content-Type":"application/x-www-form-urlencoded"},timeout:15e3};Ws.post(i).then((t=>{"string"==typeof t&&(t=JSON.parse(t)),0===t.ret?oa.info("iGotåééç¥æ¶æ¯æåð"):oa.info(`iGotåééç¥æ¶æ¯å¤±è´¥ï¼${t.errMsg}`)})).catch((t=>{oa.info("iGotåééç¥è°ç¨APIå¤±è´¥ï¼ï¼"),oa.info(t)})).finally((()=>{r("")}))}else r("")}))}function cc(t,e){return new Promise((n=>{const{PUSH_PLUS_TOKEN:r,PUSH_PLUS_USER:o}=Qs;if(r){e=e.replace(/[\n\r]/g,"<br>");const i={url:"https://www.pushplus.plus/send",data:{token:`${r}`,title:`${t}`,content:`${e}`,topic:`${o}`},headers:{"Content-Type":" application/json"},timeout:15e3};Ws.post(i).then((t=>{200===t.code?oa.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å®æã`):oa.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å¤±è´¥ï¼${t.msg}`)})).catch((t=>{oa.info(`push+åé${o?"ä¸å¯¹å¤":"ä¸å¯¹ä¸"}éç¥æ¶æ¯å¤±è´¥ï¼ï¼`),oa.info(t)})).finally((()=>{n("")}))}else n("")}))}var uc=Object.freeze({__proto__:null,sendMessage:async function(t,e){oa.info("----ãæ¶æ¯æ¨éã----"),t=`Bili-${function(t=""){const e=t.length;return e<=3?t:`${t[0]}**${t[e-1]}`}(null==Ls?void 0:Ls.nickname)||js.USERID}-${t}`,await async function(t,e,n={},r="\n\næ¬éç¥ Byï¼https://github.com/KudouRan/BiliTools"){Ys(),e+=r,await Promise.all([Zs(t,e),cc(t,e)]),await Promise.all([ec(t,e,n),nc(t,e),rc(t,e),oc(t,e),ac(t,e),sc(t,e,n),Vs(t,e),Xs(t,e),tc(t,e)])}(t,e,void 0,"")}}),fc=!y((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),lc=qt,dc=Y,pc=Ft,gc=fc,mc=hn("IE_PROTO"),hc=Object,yc=hc.prototype,vc=gc?hc.getPrototypeOf:function(t){var e=pc(t);if(lc(e,mc))return e[mc];var n=e.constructor;return dc(n)&&e instanceof n?n.prototype:e instanceof hc?yc:null},_c={},wc=_r,bc=wr,$c=Object.keys||function(t){return wc(t,bc)},Tc=v,Sc=je,Oc=Ee,kc=Ue,Cc=Q,Ic=$c;_c.f=Tc&&!Sc?Object.defineProperties:function(t,e){kc(t);for(var n,r=Cc(e),o=Ic(e),i=o.length,a=0;i>a;)Oc.f(t,n=o[a++],r[n]);return t};var Pc,xc=nt("document","documentElement"),Ec=Ue,jc=_c,Lc=wr,Ac=yn,Rc=xc,Uc=_e,Bc=hn("IE_PROTO"),Dc=function(){},Nc=function(t){return"<script>"+t+"<\/script>"},Fc=function(t){t.write(Nc("")),t.close();var e=t.parentWindow.Object;return t=null,e},zc=function(){try{Pc=new ActiveXObject("htmlfile")}catch(t){}var t,e;zc="undefined"!=typeof document?document.domain&&Pc?Fc(Pc):((e=Uc("iframe")).style.display="none",Rc.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Nc("document.F=Object")),t.close(),t.F):Fc(Pc);for(var n=Lc.length;n--;)delete zc.prototype[Lc[n]];return zc()};Ac[Bc]=!0;var Mc=Object.create||function(t,e){var n;return null!==t?(Dc.prototype=Ec(t),n=new Dc,Dc.prototype=null,n[Bc]=t):n=zc(),void 0===e?n:jc.f(n,e)},qc=St,Jc=_,Gc=R(R.bind),Kc={},Wc=Kc,Hc=ie("iterator"),Qc=Array.prototype,Yc=$o,Vc=kt,Xc=Kc,Zc=ie("iterator"),tu=function(t){if(null!=t)return Vc(t,Zc)||Vc(t,"@@iterator")||Xc[Yc(t)]},eu=$,nu=St,ru=Ue,ou=wt,iu=tu,au=TypeError,su=$,cu=Ue,uu=kt,fu=function(t,e){return qc(t),void 0===e?t:Jc?Gc(t,e):function(){return t.apply(e,arguments)}},lu=$,du=Ue,pu=wt,gu=function(t){return void 0!==t&&(Wc.Array===t||Qc[Hc]===t)},mu=cr,hu=rt,yu=function(t,e){var n=arguments.length<2?iu(t):e;if(nu(n))return ru(eu(n,t));throw au(ou(t)+" is not iterable")},vu=tu,_u=function(t,e,n){var r,o;cu(t);try{if(!(r=uu(t,"return"))){if("throw"===e)throw n;return n}r=su(r,t)}catch(t){o=!0,r=t}if("throw"===e)throw n;if(o)throw r;return cu(r),n},wu=TypeError,bu=function(t,e){this.stopped=t,this.result=e},$u=bu.prototype,Tu=function(t,e,n){var r,o,i,a,s,c,u,f=n&&n.that,l=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_RECORD),p=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),m=fu(e,f),h=function(t){return r&&_u(r,"normal",t),new bu(!0,t)},y=function(t){return l?(du(t),g?m(t[0],t[1],h):m(t[0],t[1])):g?m(t,h):m(t)};if(d)r=t.iterator;else if(p)r=t;else{if(!(o=vu(t)))throw wu(pu(t)+" is not iterable");if(gu(o)){for(i=0,a=mu(t);a>i;i++)if((s=y(t[i]))&&hu($u,s))return s;return new bu(!1)}r=yu(t,o)}for(c=d?t.next:r.next;!(u=lu(c,r)).done;){try{s=y(u.value)}catch(t){_u(r,"throw",t)}if("object"==typeof s&&s&&hu($u,s))return s}return new bu(!1)},Su=Vr,Ou=rt,ku=vc,Cu=uo,Iu=Ar,Pu=Mc,xu=We,Eu=P,ju=Uo,Lu=xo,Au=Tu,Ru=Co,Uu=Do,Bu=ie("toStringTag"),Du=Error,Nu=[].push,Fu=function(t,e){var n,r=arguments.length>2?arguments[2]:void 0,o=Ou(zu,this);Cu?n=Cu(new Du,o?ku(this):zu):(n=o?this:Pu(zu),xu(n,Bu,"Error")),void 0!==e&&xu(n,"message",Ru(e)),Uu&&xu(n,"stack",ju(n.stack,1)),Lu(n,r);var i=[];return Au(t,Nu,{that:i}),xu(n,"errors",i),n};Cu?Cu(Fu,Du):Iu(Fu,Du,{name:!0});var zu=Fu.prototype=Pu(Du.prototype,{constructor:Eu(1,Fu),message:Eu(1,""),name:Eu(1,"AggregateError")});Su({global:!0,constructor:!0,arity:2},{AggregateError:Fu});var Mu={},qu=St,Ju=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=qu(e),this.reject=qu(n)};Mu.f=function(t){return new Ju(t)};var Gu=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Ku=$,Wu=St,Hu=nt,Qu=Mu,Yu=Gu,Vu=Tu;function Xu(){oa.info("å½åçæ¬ãv0.5.220710ã")}function Zu(t,e){if(t.startsWith("v")&&(t=t.substring(1)),e.startsWith("v")&&(e=e.substring(1)),t===e)return!1;const n=t.split("."),r=e.split(".");for(let t=0;t<n.length;t++){const e=parseInt(n[t]),o=parseInt(r[t]);if(isNaN(e)||isNaN(o))return!0;if(e<o)return!0}return!1}Vr({target:"Promise",stat:!0},{any:function(t){var e=this,n=Hu("AggregateError"),r=Qu.f(e),o=r.resolve,i=r.reject,a=Yu((function(){var r=Wu(e.resolve),a=[],s=0,c=1,u=!1;Vu(t,(function(t){var f=s++,l=!1;c++,Ku(r,e,t).then((function(t){l||u||(u=!0,o(t))}),(function(t){l||u||(l=!0,a[f]=t,--c||i(new n(a,"No one promise resolved")))}))})),--c||i(new n(a,"No one promise resolved"))}));return a.error&&i(a.value),r.promise}});var tf=Object.freeze({__proto__:null,printVersion:async function(){let t="v0.5.220710";t.includes(".")?Xu():t=void 0;try{if(t||(t="v"+(function(){try{return require("../../package.json").version}catch{}}()||function(){try{return f.readFileSync(u.resolve(__dirname,"../version.txt"),"utf8").trim()}catch{}}()),oa.info(`å½åçæ¬ã${t}ã`)),!t)return;const e=await async function(){const t={timeout:6e3};try{return(await Promise.any([Ws.get("https://api.github.com/repos/KudouRan/BiliTools/releases/latest",t),Ws.get("https://gitee.com/api/v5/repos/KudouRan/BiliTools/releases/latest",t)])).tag_name}catch(t){return}}();e&&Zu(t,e)&&oa.info(`å¯æ´æ°ï¼ææ°çæ¬ã${e}ã`)}catch{}},printStrVersion:Xu,checkVersion:Zu});const ef=Ks({baseURL:vs,headers:{"user-agent":js.userAgent}}),nf=Ks({baseURL:_s,headers:{Referer:ms,"user-agent":js.userAgent}}),rf=Ks({baseURL:ws,headers:{Referer:ms,"user-agent":js.userAgent}}),of=Ks({baseURL:bs,headers:{"user-agent":js.userAgent}}),af=Ks({baseURL:$s,headers:{"user-agent":js.userAgent}}),sf=Ks({baseURL:Ts,headers:{"user-agent":js.userAgent}});function cf(){return rf.get("x/web-interface/nav",{headers:{Origin:fs}})}function uf(){return ef.get("site/getCoin")}function ff(t=1,e=50,n=-10){return rf.get("x/relation/tag",{params:{tagid:n,pn:t,ps:e}})}function lf(t){return rf.post("x/relation/modify",{fid:t,act:2,re_src:11,spmid:"333.999.0.0",jsonp:"jsonp",csrf:js.BILIJCT})}function df(t,e){return rf.post("x/relation/tags/addUsers?cross_domain=true",{fids:t,tagids:e,csrf:js.BILIJCT},{headers:{Origin:ds}})}function pf(t,e,n=1){return rf.post("/x/web-interface/coin/add",{aid:t,multiply:e,selectLike:n,csrf:js.BILIJCT})}function gf(t,e=1){return Hs.post("https://www.bilibili.com/audio/music-service-c/web/coin/add",{sid:t,multiply:e,csrf:js.BILIJCT})}const mf="video",hf="audio",yf="article";async function vf(t=!0){try{const e=js.USERID,{data:n,message:r,code:o}=await(t?function(t=1,e=50){return ff(t,e,-10)}():function(t,e=1,n=50,r="desc",o="attention"){return rf.get("x/relation/followings",{params:{vmid:t,pn:e,ps:n,order:r,order_type:o}})}(e)),i=t?n:n.list;if(!i||0===i.length)return{msg:"æ²¡æå³æ³¨åè¡¨",code:1,data:{}};if(0===o){await Us();const{mid:t}=Hi(i)||{};return await bf(t)}return{msg:t?`æªè·åå°ç¹å«å³æ³¨åè¡¨: ${o}-${r}`:`æªè·åå°å³æ³¨åè¡¨: ${o}-${r}`,code:-1,data:{}}}catch(t){return{msg:t.message,code:-2,data:{}}}}async function _f(){const t=Hi([1,3,4,5,160,22,119]);try{const{data:e,message:n,code:r}=await function(t=1,e=3){return rf.get("/x/web-interface/ranking/region",{params:{rid:t,day:e}})}(t,3);if(0==r){const{aid:t,title:n,author:r}=Hi(e);return{code:0,data:{id:Number(t),title:n,author:r}}}return{msg:`æªè·åå°æè¡ä¿¡æ¯: ${r}-${n}`,code:-1,data:{}}}catch(t){return{msg:t.message,code:-2,data:{}}}}async function wf(){const t=js.coin.customizeUp;return 0===t.length?{code:1,data:{}}:await bf(Hi(t))}async function bf(t){try{const{code:e,data:n,message:r}=await function(t){return rf.get(`/x/space/navnum?mid=${t}`)}(t);if(e)return{msg:`éè¿uidè·åè§é¢å¤±è´¥: ${e}-${r}`,code:-1,data:{}};await Us();const{video:o,audio:i,article:a}=n,s=function([t,e,n]){const r=t+e+n;if(!r)return;const o=Ni(0,r-1);let i=o;if(o<t)return{coinType:mf,page:Di(30,i+1),index:i%30};const a=t+e;return i=o-t,o<a?{coinType:hf,page:Di(30,i+1),index:i%30}:(i=o-a,{coinType:yf,page:Di(12,i+1),index:i%12})}([o,i,a]);if(!s)return{msg:"ç¨æ·æ²¡ææç¨¿",code:1,data:{}};const{coinType:c,page:u,index:f}=s,l={[mf]:$f,[hf]:Tf,[yf]:Sf},d=await l[c](t,u,f);return d.message?{msg:d.message,code:-1,data:{}}:{code:0,data:d}}catch(t){return oa.debug(t),{msg:t.message,code:-2,data:{}}}}async function $f(t,e,n){const{code:r,data:o,message:i}=await function(t,e=30,n=1,r=""){return rf.get("/x/space/arc/search",{params:{jsonp:"jsonp",order:"pubdate",keyword:r,pn:n,tid:0,ps:e,mid:t}})}(t,30,e);if(r)return{message:i};const{aid:a,title:s,author:c}=o.list.vlist[n];return{coinType:mf,id:a,title:s,author:c}}async function Tf(t,e,n){const{code:r,data:o,msg:i}=await function(t,e=30,n=1){return rf.get("/audio/music-service/web/song/upper",{params:{jsonp:"jsonp",order:1,pn:n,ps:e,uid:t}})}(t,30,e);if(r)return{message:i};const{data:a}=o,{id:s,uname:c,title:u}=a[n];return{coinType:hf,id:s,title:u,author:c}}async function Sf(t,e,n){const{code:r,data:o,message:i}=await function(t,e=12,n=1){return rf.get("/x/space/article",{params:{callback:"__test",jsonp:"jsonp",sort:"publish_time",pn:n,ps:e,mid:t},requestOptions:{isJsonp:!0}})}(t,12,e);if(r)return{message:i};const{articles:a}=o,{id:s,title:c,author:{name:u}}=a[n];return{coinType:yf,id:s,title:c,author:u,mid:t}}function Of(){return vf(!1)}async function kf(){const t=function(){const t=function(){var t;const e=[wf,vf,Of,_f];return 0===(null===(t=js.coin.customizeUp)||void 0===t?void 0:t.length)&&e.shift(),e}();return t.splice(0,Ls.currentStartFun),t[0]||_f}();return await Us(),t()}async function Cf({id:t,coin:e=1,coinType:n="video",mid:r}){const o={[mf]:pf,[hf]:gf,[yf]:(t,e=1)=>function(t,e,n=1){return rf.post("/x/web-interface/coin/add",{aid:e,upid:t,avtype:2,multiply:n,csrf:js.BILIJCT})}(r,t,e)},i=await o[n](Number(t),e);return{code:i.code,message:i.message||i.msg}}async function If(){const t=await async function(){try{const{data:t,code:e}=await rf.get("x/web-interface/coin/today/exp");if(0===e)return t/10}catch(t){oa.debug(`è·åæå¸æ°éå¼å¸¸ ${t.message}`)}}();return t||await async function(){try{const{code:t,message:e,data:n}=await rf.get("x/member/web/coin/log?jsonp=jsonp",{headers:{origin:fs}});if(0!==t)return void oa.warn(`è·åæå¸æ¶èç¡¬å¸å¤±è´¥ï¼${t} ${e}`);const r=n.list;if(!r||!r.length)return;const o=r.filter((t=>{if(-2!==t.delta&&-1!==t.delta)return!1;const{reason:e,time:n}=t;return e&&n&&e.startsWith("ç»")&&e.endsWith("æèµ")?!!n.startsWith(Ui()):void 0})).reduce(((t,e)=>t+e.delta),0);return Math.abs(o)}catch(t){oa.debug(`è·åæå¸æ¶èç¡¬å¸å¼å¸¸ ${t.message}`)}}()}var Pf=Object.freeze({__proto__:null,default:async function(){oa.info("----ãæ¯æ¥ä»»å¡å®ææåµã----");try{const{data:t,message:e,code:n}=await rf.get("x/member/web/exp/reward");await Us();const r=await If();if(0!=n)return void oa.warn(`ç¶æè·åå¤±è´¥: ${n} ${e}`);const o=Ls.money-js.coin.stayCoins;let i=0;0===Ls.coinsTask?oa.info(`ä»æ¥æå¸æ°éï¼${r}ï¼è¿éæå¸0é¢ï¼ç»éªå¤äºï¼ä¸æ³æäº`):o<=0?oa.info(`ä»æ¥æå¸æ°éï¼${r}ï¼è¿éæå¸0é¢ï¼ç¡¬å¸ä¸å¤äºï¼ä¸æå¸äº`):o<Ls.coinsTask?(i=o,oa.info(`æå¸æ°é: ${r}ï¼è¿è½æå¸æ°é: ${o}é¢;(ç®æ ${Ls.coinsTask}é¢ï¼å¿½ç¥é¨åæå¸)`)):(i=Ls.coinsTask-r,oa.info(`æå¸æ°éï¼${r}ï¼è¿éæå¸æ°é: ${i}é¢;(ç®æ ${Ls.coinsTask}é¢)`)),Ls.coinsTask=i,oa.info("æ¯æ¥åäº«: "+(t.share?"å·²å®æ":"[æªå®æ]")),oa.info("æ¯æ¥æ­æ¾: "+(t.watch?"å·²å®æ":"[æªå®æ]")),Ls.share=t.share,Ls.watch=t.watch}catch(t){oa.error(`ç¶æè·åå¼å¸¸ ${t.message}`)}}});function xf(t=1,e=50,n=1){return nf.get(`/xlive/app-ucenter/v1/fansMedal/panel?page=${t}&page_size=${e}&target_id=${n}`)}function Ef({ruid:t,gift_num:e,bag_id:n,gift_id:r,roomid:o}){const i=js.BILIJCT,a=i,s={gift_id:r,ruid:t,gift_num:e,bag_id:n,biz_id:o,rnd:(new Date).getTime(),send_ruid:0,storm_beat_id:0,metadata:"",price:0,visit_id:"",csrf:i,platform:"pc",biz_code:"Live",csrf_token:a,uid:js.USERID};return nf.post("/xlive/revenue/v2/gift/sendBag",s,{headers:{Origin:ls}})}function jf(t){return nf.get(`/xlive/lottery-interface/v1/Anchor/Check?roomid=${t}`)}var Lf=Object.freeze({__proto__:null,default:async function(){oa.info("----ãç´æ­ç­¾å°ã----");try{const{data:t}=await nf.get("/xlive/web-ucenter/v1/sign/WebGetSignInfo");if(1===t.status)return oa.info("å·²ç­¾å°ï¼è·³è¿ç­¾å°"),void oa.info(`å·²ç»ç­¾å°${t.hadSignDays}å¤©ï¼${t.specialText}`)}catch(t){oa.debug(`ç´æ­ç­¾å°ï¼${t.message}`)}try{const{code:t,data:e,message:n}=await nf.get("/xlive/web-ucenter/v1/sign/DoSign");0===t?oa.info(`ç´æ­ç­¾å°æå: ${e.text}ï¼ç¹å«ä¿¡æ¯: ${e.specialText}ï¼æ¬æç­¾å°å¤©æ°: ${e.hadSignDays}å¤©;`):oa.warn(`ç´æ­ç­¾å°å¤±è´¥: ${t} ${n}`)}catch(t){oa.error(`ç´æ­ç­¾å°å¼å¸¸: ${t.message}`)}}});async function Af(t){if(await async function(){let t=await If();t||(t=js.coin.todayCoins);const e=js.coin.targetCoins-t;Ls.coinsTask=e>0?e:0}(),Ls.coinsTask<=0||Ls.money<=0)return!0;const{data:e,code:n,msg:r}=await kf();return 1===n?(Ls.currentStartFun++,!1):e&&e.id&&0===n?t.prevFillId===e.id?(Ls.currentStartFun++,!1):(await Us(),await async function(t,e){const{id:n,coinType:r,mid:o}=t;try{const i=await Cf({id:n,coinType:r,mid:o});switch(i.code){case 0:return function(t,{title:e,author:n}){return Ls.money--,Ls.coinsTask--,t.num++,oa.info(`ç»[ ${e}--upã${n}ã]æå¸æå`),!1}(e,t);case 34005:return function(t,e){e.fillCount++,e.prevFillId=t,oa.verbose(`å½åç¨¿ä»¶[${t}]ä¸è½åæå¸äº`),e.fillCount>=3&&(oa.warn("è¯¥ç±»åçç¨æ·ç»ä¼¼ä¹æ²¡æå¸å¯æäº"),e.fillCount=0,Ls.currentStartFun++);return!1}(n,e);case-104:case-111:return function(t,e){return oa.warn(`${t} ${e.message} æ æ³ç»§ç»­è¿è¡æå¸`),!0}(n,i);default:return function(t,e,n){if(e.eCount++,oa.warn(`ç»${t}æå¸å¤±è´¥ ${n.code} ${n.message}`),e.prevCode===n.code)return!0;return e.prevCode=n.code,!1}(n,e,i)}}catch(t){e.eCount++,oa.error(`æå¸å¼å¸¸ ${t.message}`)}return!1}(e,t)):(r&&oa.debug(r),t.eAidCount++,t.eAidCount>=10&&(oa.warn("è·åç¨¿ä»¶éè¯¯æ¬¡æ°è¶è¿ 10 æ¬¡ï¼èªå¨éåºæå¸"),!0))}var Rf=Object.freeze({__proto__:null,default:async function(){if(oa.info("----ãè§é¢æå¸ã----"),!Ls.coinsTask)return void oa.info("è·³è¿æå¸ï¼ä»æ¥å·²å®æ");const t={eCount:0,num:0,prevCode:void 0,fillCount:0,prevFillId:void 0,eAidCount:0};let e=!1;for(;Ls.coinsTask>0&&!e&&t.eCount<5&&t.num<5;)e=await Af(t);t.eCount>=5&&oa.info("åºç°å¼å¸¸/éè¯¯5æ¬¡ï¼èªå¨éåºæå¸"),oa.info(`ä¸å±æåæå¸${t.num}é¢`),oa.info(`ç¡¬å¸è¿å©${Ls.money}é¢`)}}),Uf=ie,Bf=Mc,Df=Ee.f,Nf=Uf("unscopables"),Ff=Array.prototype;null==Ff[Nf]&&Df(Ff,Nf,{configurable:!0,value:Bf(null)});var zf=Ft,Mf=cr,qf=er,Jf=function(t){Ff[Nf][t]=!0};Vr({target:"Array",proto:!0},{at:function(t){var e=zf(this),n=Mf(e),r=qf(t),o=r>=0?r:n+r;return o<0||o>=n?void 0:e[o]}}),Jf("at");var Gf=Vr,Kf=K,Wf=er,Hf=Oo,Qf=y,Yf=R("".charAt);Gf({target:"String",proto:!0,forced:Qf((function(){return"\ud842"!=="ð ®·".at(-2)}))},{at:function(t){var e=Hf(Kf(this)),n=e.length,r=Wf(t),o=r>=0?r:n+r;return o<0||o>=n?void 0:Yf(e,o)}});const Vf={"app-key":"android64",env:"prod","user-agent":js.mobileUA};const Xf={ogvwatch:"è§çæ­£ç",tvodbuy:"è´­ä¹°è§é¢",vipmallbuy:"è´­ä¹°åå",bonus:"å¤§ä¼åç¦å©",privilege:"æµè§ä¼åæç","626act":"æµè§âæçåå©å°å±â",animatetab:"æµè§è¿½çª",filmtab:"æµè§å½±è§",vipmallview:"æµè§ä¼åè´­"};async function Zf(){try{const{code:t,data:e,message:n}=await rf.get("x/vip_point/task/combine",{headers:Vf});return 0!==t&&oa.error(`æ¥çå½åç¶æå¤±è´¥: ${t} ${n}`),e}catch(t){oa.error(t)}}async function tl(){var t;const e=await Zf();if(!e)return;const{vip_info:{status:n,type:r},point_info:{point:o},task_info:i}=e;if(!async function(t,e,n){if(oa.info(`å½åç§¯å: ${n}`),0===t||0===e)return void oa.warn("å½åæ å¤§ä¼åï¼æ æ³ç»§ç»­æ§è¡ä»»å¡");return!0}(n,r,o))return;if(i.score_month>=i.score_limit)return void oa.info("æ¬æç§¯åå·²é¢åå®");-401!==await async function(t){if(!t||!t.length)return;const e=t.find((t=>t.is_today));if(!e)return;if(e.signed)return void oa.info("ä»æ¥å·²ç­¾å° â");try{const{code:t,message:e}=await rf.post("pgc/activity/score/task/sign",ks({csrf:js.BILIJCT}),{headers:Vf});return 0===t?(oa.info("ç­¾å°æå â"),t):(oa.error(`ç­¾å°å¤±è´¥: ${t} ${e}`),t)}catch(t){oa.error(t)}return-1}(null===(t=i.sing_task_item)||void 0===t?void 0:t.histories)?(await Us(100,200),await async function(t){var e,n;function r(t){return!!t&&(!(t.vip_limit>Ls.vipType)&&(0===t.state||void 0))}const o=null===(e=t.modules.at(-1))||void 0===e||null===(n=e.common_task_item)||void 0===n?void 0:n.filter(r);if(!o||!o.length)return oa.info("æ²¡æéè¦é¢åçä»»å¡"),!1;return await async function(t){for(const e of t)await il(e),await Us(100,300)}(o.map((t=>t.task_code))),oa.info("é¢åä»»å¡å®æ"),!0}(i)?(await Us(100,200),await el(await Zf())):await el(e)):oa.error("åºç°éæ³è®¿é®å¼å¸¸ï¼å¯è½è´¦å·å­å¨å¼å¸¸ï¼æ¾å¼å¤§ç§¯åä»»å¡")}async function el(t){var e,n;if(!t||!t.task_info)return;const r=null===(e=t.task_info.modules)||void 0===e||null===(n=e.at(-1))||void 0===n?void 0:n.common_task_item;if(!r)return void oa.info("æ²¡æéè¦å®æçæ¯æ¥ä»»å¡");const o=r.filter((t=>!(t.vip_limit>Ls.vipType)&&(!(t.complete_times>=t.max_times)&&(1===t.state||void 0))));await async function(t){for(const e of t){switch(e.task_code){case"ogvwatch":await nl(e.complete_times);break;case"filmtab":await rl("tv_channel","æµè§å½±è§é¢é");break;case"animatetab":await rl("jp_channel","æµè§è¿½çªé¢é");break;case"vipmallview":await ol()}await Us(1e3,3e3)}}(o)}async function nl(t){try{const e=function(t,e,n,r=[]){let o=Ni(e,n);for(;r.includes(o);)o=Ni(e,n);return Number(t+o)}("327",107,134,[122,123]),n=1===t?Ni(905,1800):Ni(1805,2e3);await function({start_ts:t,aid:e=243332804,cid:n=209599683,type:r=4,sub_type:o=5,dt:i=2,play_type:a=0,realtime:s=0,played_time:c=10,real_played_time:u=0,refer_url:f="",sid:l=33622,epid:d=327107}){return rf.post("x/click-interface/web/heartbeat",{start_ts:t,mid:js.USERID,aid:e,cid:n,type:r,sub_type:o,dt:i,play_type:a,realtime:s,played_time:c,real_played_time:u,refer_url:f,bsource:"",sid:l,epid:d,spmid:"666.25",from_spmid:"..0.0",csrf:js.BILIJCT})}({start_ts:Xi()-n,realtime:n,played_time:Ni(1e3)+n,real_played_time:n,refer_url:"https://www.bilibili.com/bangumi/media/md28229051/",epid:e}),oa.info("è§çè§é¢ï¼è¥¿æ¸¸è®°ï¼ä»»å¡ â")}catch(t){oa.error(t),oa.error(`è§çè§é¢ä»»å¡åºç°å¼å¸¸ï¼${t.message}`)}}async function rl(t,e){try{await rf.post("pgc/activity/deliver/susWin/receive",ks({csrf:js.BILIJCT}),{headers:Vf}),Us(1e3,2e3);const{code:r,message:o}=await(n=t,rf.post("pgc/activity/deliver/task/complete",ks({csrf:js.BILIJCT,position:n}),{headers:{...Vf,referer:hs}}));if(0!==r)return void oa.error(`${e}å¤±è´¥: ${r} ${o}`);oa.info(`${e}æ¯æ¥ä»»å¡ â`)}catch(t){oa.error(t),oa.error(`æ¯æ¥ä»»å¡${e}åºç°å¼å¸¸ï¼${t.message}`)}var n}async function ol(){try{const{code:e,message:n}=await(t="hevent_oy4b7h3epeb",Hs.post(`https://show.bilibili.com/api/activity/fire/common/event/dispatch?${ks({csrf:js.BILIJCT})}`,{eventId:t},{headers:{"content-type":"application/json; charset=utf-8",...Vf}}));if(0===e)return void oa.info("æµè§ä¼åè´­æ¯æ¥ä»»å¡ â");oa.error(`æµè§ä¼åè´­å¤±è´¥: ${e} ${n}`)}catch(t){oa.error(t),oa.error(`æ¯æ¥ä»»å¡ä¼åè´­åºç°å¼å¸¸ï¼${t.message}`)}var t}async function il(t){try{const{code:e,message:n}=await function(t="ogvwatch"){return rf.post("pgc/activity/score/task/receive",{csrf:js.BILIJCT,ts:Xi(),taskCode:t},{http2:!0,headers:{"Content-Type":"application/json; charset=utf-8",Referer:ys,...Vf,navtive_api_from:"h5"}})}(t);if(0===e)return!0;oa.error(`é¢åä»»å¡${Xf[t]}å¤±è´¥: ${e} ${n}`)}catch(t){oa.error(t)}}var al=Object.freeze({__proto__:null,default:async function(){oa.info("----ãå¤§ä¼åç§¯åã----");try{if(0===Ls.vipType||0===Ls.vipStatus)return void oa.info("å½åä¸æ¯å¤§ä¼åï¼è·³è¿ä»»å¡");await tl(),oa.info("å¤§ä¼åç§¯åä»»å¡ç»æ")}catch(t){oa.error(`å¤§ä¼åç§¯åä»»å¡å¼å¸¸: ${t.message}`)}}});var sl=Object.freeze({__proto__:null,default:async function(){if(oa.info("----ãåäº«/æ­æ¾è§é¢ã----"),Ls.share&&Ls.watch)return void oa.info("å·²å®æï¼è·³è¿åäº«/æ­æ¾");let t=0;try{let e=await kf();if(0!==e.code&&(e=await _f()),0!==e.code)return oa.warn(`è·åè§é¢å¤±è´¥ ${e.msg}`),!1;{const{id:n,author:r,title:o}=e.data;t=n,oa.info(`è·åè§é¢: ${o} --upã${r}ã`)}}catch(t){return oa.error(`è·åè§é¢åºç°å¼å¸¸: ${t.message}`),!1}if(!Ls.share){await Us();try{const{code:e,message:n}=await function(t){const e={csrf:js.BILIJCT,aid:t};return rf.post("/x/web-interface/share/add",e)}(t);0===e?oa.info("åäº«è§é¢æå!"):oa.warn(`åäº«è§é¢å¤±è´¥: ${e} ${n}`)}catch(t){oa.error(`åäº«è§é¢å¼å¸¸: ${t.message}`)}}if(!Ls.watch){await Us();try{const{code:r,message:o}=await(e=t,n=Ni(4,60),rf.post("/x/click-interface/web/heartbeat",{aid:e,played_time:n}));0===r?oa.info("æ­æ¾è§é¢æå!"):oa.warn(`æ­æ¾è§é¢å¤±è´¥: ${r} ${o}`)}catch(t){oa.error(`æ­æ¾è§é¢å¼å¸¸: ${t.message}`)}}var e,n}});var cl=Object.freeze({__proto__:null,default:async function(){oa.info("----ãé¶çå­åæ¢ç¡¬å¸ã----");try{const{data:t,code:e,message:n}=await nf.get("/xlive/revenue/v1/wallet/getStatus");if(0!=e&&oa.info(`è·åçå­è¯¦æå¤±è´¥ ${n}`),0===t.silver_2_coin_left)oa.info("ä»æ¥å·²åæ¢ä¸æ¬¡");else if(t.silver<700)oa.info("åæ¢å¤±è´¥ï¼ä½ çå­ä¸å¤äº");else{const{message:t}=await nf.post("/xlive/revenue/v1/wallet/silver2coin",{csrf_token:js.BILIJCT,csrf:js.BILIJCT});oa.info(`åæ¢ç¡¬å¸ï¼ ${t}`),await nf.get("/xlive/revenue/v1/wallet/myWallet?need_bp=1&need_metal=1&platform=pc")}}catch(t){oa.error(`æä½å¼å¸¸ ${t.message}`)}}});let ul;async function fl(){ul=0;try{const{code:t,msg:e,data:n}=await function(t=1,e=50){return of.post("twirp/user.v1.User/GetCoupons?platform=web",{not_expired:!0,page_num:t,page_size:e,tab_type:1})}();if(0!==t)return void oa.error(`è·åæ¼«è¯»å¸å¤±è´¥ï¼${t} ${e}`);const{user_coupons:r}=n;if(0===r.length)return void oa.info("æ²¡ææ¼«è¯»å¸ï¼è·³è¿ä»»å¡");const o=r.filter((t=>0!==t.will_expire));return ul=o.reduce(((t,e)=>t+e.remain_amount),0),ul}catch(t){oa.error(`è·åæ¼«è¯»å¸å¼å¸¸: ${t}`)}}async function ll(){try{const{code:t,msg:e,data:n}=await function(t=1,e=50,n=1){return of.post("twirp/bookshelf.v1.Bookshelf/ListFavorite?platform=web",{page_num:t,page_size:e,order:n,wait_free:0})}();if(0===t)return n;oa.error(`è·åè¿½æ¼«åè¡¨å¤±è´¥ï¼${t} ${e}`)}catch(t){oa.error(`è·åè¿½æ¼«åè¡¨å¼å¸¸: ${t}`)}}async function dl(t){try{const{code:e,msg:n,data:r}=await function(t){return of.post("twirp/comic.v1.Comic/ComicDetail",{device:"android",version:"4.16.0",comic_id:t})}(t);if(0!==e)return void oa.error(`è·åæ¼«ç»è¯¦æå¤±è´¥ï¼${e} ${n}`);if(!r||!r.ep_list)return;let o=r.ep_list;return 0!==r.disable_coupon_amount&&(o=o.slice(0,o.length-r.disable_coupon_amount)),o.filter((t=>t.is_locked))}catch(t){oa.error(`è·åæ¼«ç»è¯¦æå¼å¸¸: ${t}`)}}async function pl(t){try{const{code:e,msg:n,data:r}=await function(t){return of.post("twirp/comic.v1.Comic/GetEpisodeBuyInfo?platform=web",{ep_id:t})}(t);if(0!==e)return void oa.error(`è·åè´­ä¹°ä¿¡æ¯å¤±è´¥ï¼${e} ${n}`);if(!r)return;if(!r.allow_coupon)return void oa.info("æ¼«ç»ä¸æ¯ææ¼«è¯»å¸");if(0===r.recommend_coupon_id||0===r.remain_coupon)return ul=0,void oa.info("æ²¡æè¶³å¤çæ¼«è¯»å¸äº");if(!r.remain_lock_ep_num)return;return r.recommend_coupon_id}catch(t){oa.error(`è·åè´­ä¹°ä¿¡æ¯å¼å¸¸: ${t}`)}}async function gl(t){try{const e=await pl(t);if(!e)return!0;const{code:n,msg:r}=await function(t,e,n=2,r=0){return of.post("twirp/comic.v1.Comic/BuyEpisode?&platform=web",{buy_method:n,ep_id:t,coupon_id:e,auto_pay_gold_status:r})}(t,e);if(0!==n)return void oa.error(`è´­ä¹°æ¼«ç»å¤±è´¥ï¼${n} ${r}`);ul--,oa.info("è´­ä¹°æ¼«ç»æå")}catch(t){oa.error(`è´­ä¹°æ¼«ç»å¼å¸¸: ${t}`)}}async function ml(t){try{const{code:e,msg:n,data:r}=await function(t,e=1,n=9){return of.post("twirp/comic.v1.Comic/Search?device=pc&platform=web",{keyword:t,page_num:e,page_size:n})}(t);if(0===e)return r;oa.error(`æç´¢æ¼«ç»å¤±è´¥ï¼${e} ${n}`)}catch(t){oa.error(`æç´¢æ¼«ç»å¼å¸¸: ${t}`)}}async function hl(t){const e=await dl(t);if(!e||0===e.length)return!1;for(let t=0;t<e.length;t++)if(await Us(100),await gl(e[t].id))return!0}async function yl(){ul=await fl(),ul<1?oa.info("æ²¡æå³å°è¿æçæ¼«è¯»å¸ï¼è·³è¿ä»»å¡"):(await async function(){const{mc:t}=js.manga;if(0!==t.length)for(let e=0;e<t.length;e++){if(ul<=0)return;const n=t[e];await hl(n)}}(),await async function(){const{name:t}=js.manga;if(0!==t.length)for(let e=0;e<t.length;e++){if(ul<=0)return;const n=t[e],r=await ml(n);if(!r||0===r.list.length)continue;const o=r.list.find((t=>t.title===n));o&&await hl(o.id)}}(),await async function(){const{love:t}=js.manga;if(!t||ul<=0)return;const e=await ll();if(e&&0!==e.length)for(let t=0;t<e.length;t++){if(ul<=0)return;const n=e[t];await hl(n.comic_id)}}())}async function vl(){try{const{code:t}=await function(t="android"){return of.post("twirp/activity.v1.Activity/ClockIn",{platform:t})}();0==t?oa.info("æ¼«ç»ç­¾å°æå"):oa.warn("æ¼«ç»ç­¾å°å¤±è´¥")}catch(t){const{status:e,statusCode:n}=t.response||{};400===e||400===n?oa.info("å·²ç»ç­¾å°è¿äºï¼è·³è¿ä»»å¡"):oa.error(`æ¼«ç»ç­¾å°å¼å¸¸ ${t.message}`)}}var _l=Object.freeze({__proto__:null,default:async function(){oa.info("----ãæ¼«ç»ç­¾å°ã----"),oa.warn("æ¼«ç»ç­¾å°ä»»å¡ç§»å¨å°äºæ¼«ç»ä»»å¡ä¸­ï¼è¯·ä¿®æ¹ä¸ºæ°çä»»å¡"),await vl()}});var wl=Object.freeze({__proto__:null,default:async function(){oa.info("----ãæ¼«ç»ä»»å¡ã----");const{manga:t}=js;try{t.sign&&(oa.info("å¼å§ç­¾å°"),await vl());t.buy&&function(){const{buyWeek:t,buyInterval:e}=js.manga;if(!t||0===t.length)return!1;if(1===e)return!0;const n=new Date,r=n.getDay(),o=n.getDate();return t.includes(r)||o%e-1==0}()?(oa.info("å¼å§è´­ä¹°æ¼«ç»"),await yl()):oa.info("éè´­ä¹°æ¼«ç»æ¶é´ï¼ä¸è´­ä¹°")}catch(t){oa.error(`æ¼«ç»ä»»å¡å¼å¸¸: ${t}`)}}});async function bl(){try{const{data:t,code:e,message:n}=await af.get("/link_group/v1/member/my_groups");return 0===e?(null==t?void 0:t.list)||[]:(oa.warn(`è·åèªå·±çåºæ´å¢å¼å¸¸å¤±è´¥: ${n}`),[])}catch(t){oa.error(`è·åèªå·±çåºæ´å¢å¼å¸¸: ${t}`)}}async function $l(t,e){try{const{data:o,code:i,message:a}=await(n=t.group_id,r=t.owner_uid,af.get("/link_setting/v1/link_setting/sign_in",{params:{group_id:n,owner_id:r}}));if(0!==i)return void oa.warn(`[${t.group_name}]ç­¾å°å¤±è´¥ ${a}`);0===o.status?e.value++:oa.verbose(`ç­¾å°å¤±è´¥: ${o.status} ${a}`)}catch(t){oa.error(`ç­¾å°å¼å¸¸ ${t.message}`)}finally{await Us(400,1e3)}var n,r}var Tl=Object.freeze({__proto__:null,default:async function(){oa.info("----ãåºæ´å¢ç­¾å°ã----");const t=await bl();await Us();const e={value:0};for(let n=0;n<t.length;n++){const r=t[n];await $l(r,e)}oa.info(`ç­¾å°ç»æï¼æå${e.value}/${t.length}`)}}),Sl=$,Ol=St,kl=Mu,Cl=Gu,Il=Tu;function Pl({buvid:t=xs(),gu_id:e=zi(43).toLocaleUpperCase(),visit_id:n=zi(32).toLocaleLowerCase(),uuid:r=Ai(),click_id:o=Ai(),room_id:i,up_id:a,uid:s,up_level:c=40,up_session:u="",parent_id:f=11,area_id:l=376}){const d={platform:"android",uuid:r,buvid:t,seq_id:"1",room_id:i,parent_id:f,area_id:l,timestamp:String(parseInt(String((new Date).getTime()/1e3))-60),secret_key:"axoaadsffcazxksectbbb",watch_time:"60",up_id:a||s,up_level:c,jump_from:"30000",gu_id:e,play_type:"0",play_url:"",s_time:"0",data_behavior_id:"",data_source_id:"",up_session:u,visit_id:n,watch_status:"",click_id:o,session_id:"-99998",player_type:"0",client_ts:String(parseInt(String((new Date).getTime()/1e3)))},p={...d,ts:parseInt(String((new Date).getTime()/1e3)),client_sign:Ps(d),csrf_token:js.BILIJCT,csrf:js.BILIJCT};return sf.post("xlive/data-interface/v1/heartbeat/mobileHeartBeat",p)}Vr({target:"Promise",stat:!0},{allSettled:function(t){var e=this,n=kl.f(e),r=n.resolve,o=n.reject,i=Cl((function(){var n=Ol(e.resolve),o=[],i=0,a=1;Il(t,(function(t){var s=i++,c=!1;a++,Sl(n,e,t).then((function(t){c||(c=!0,o[s]={status:"fulfilled",value:t},--a||r(o))}),(function(t){c||(c=!0,o[s]={status:"rejected",reason:t},--a||r(o))}))})),--a||r(o)}));return i.error&&o(i.value),n.promise}});const xl=["(ââ½â)","ï¼ï¿£â½ï¿£ï¼","(=ã»Ïã»=)","(ï½ã»Ïã»Â´)","(ãï¿£â³ï¿£)ã","(ï½¥âï½¥)","(Â°âÂ°)ï¾","(ï¿£3ï¿£)","â®(ï¿£â½ï¿£)â­","_(:3ãâ )_","( Â´_ãï½)","â_â","â_â","(<_<)","(>_>)","(;Â¬_Â¬)","(ï¾Ðï¾â¡ï¾Ð´ï¾)!?","Î£(ï¾Ð´ï¾;)","Î£( ï¿£â¡ï¿£||)","(Â´ï¼Ïï¼`)","ï¼/TÐT)/","(^ã»Ïã»^ )","(ï½¡ï½¥Ïï½¥ï½¡)","(âï¿£(ï½´)ï¿£â)","Îµ=Îµ=(ãâ§ââ¦)ã","(Â´ï½¥_ï½¥`)","(-_-#)","ï¼ï¿£ã¸ï¿£ï¼","(ï¿£Îµ(#ï¿£) Î£","ã½(`ÐÂ´)ï¾","ï¼#-_-)â¯ââ¯","(â¯Â°å£Â°)â¯(â´ââ´","ââ¡â","( â¥Ð´â¥)","Î£>â(ãÂ°ÏÂ°ã)â¡â","â(â ââ¢âÏââ¢â â)â","(â¬ï¾Ð´ï¾)âï¸»â»â³âä¸","ï½¥*ï½¥:â¡(ãÎµ:)","(æ±)","(è¦ç¬)"].concat("1","2","3","4","5","6","7","8","9","ç­¾å°","åå"),El=new na({console:"debug",file:"debug",push:"warn",payload:Ls.nickname},"live");async function jl(){let t=99,e=0;const n=[];try{for(;e<t;){const{code:r,message:o,data:i}=await xf(e+1,50,js.USERID);if(0!==r)return oa.verbose(`è·ååç« ä¿¡æ¯å¤±è´¥ ${r} ${o}`),null;if(!i)return n;t=i.page_info.total_page,e=i.page_info.current_page,n.push(...i.list,...i.special_list)}return n}catch(t){return oa.error(`è·ååç« å¼å¸¸ ${t.message}`),null}}function Ll({room_info:t,medal:e}){if(null==t||!t.room_id)return!1;if(e.level>=20)return!1;if(e.today_feed>=e.day_limit)return!1;if(e.today_feed>=1300)return!1;const{whiteList:n,blackList:r}=js.intimacy;return n&&n.length?!(!n.includes(t.room_id)&&!n.includes(e.target_id)):!r||!r.includes(t.room_id)&&!r.includes(e.target_id)}async function Al(t,e){const n=xl[Ni(xl.length-1)];try{const{code:r,message:o}=await function(t,e){const n=js.BILIJCT,r=n;return e||(e=Ni(10).toString()),nf.post("/msg/send",{color:5566168,fontsize:25,mode:1,msg:e,rnd:Date.now(),roomid:t,bubble:0,csrf:n,csrf_token:r})}(t,n);return 0===r||(11e3===r?(oa.warn(`ã${e}ã${t}-å¯è½æªå¼å¯è¯è®º`),!1):(oa.warn(`ã${e}ã${t}-åéå¤±è´¥ ${o}`),oa.verbose(`code: ${r}`),!1))}catch(t){oa.verbose(`åéå¼¹å¹å¼å¸¸ ${t.message}`)}}async function Rl(t){try{const{code:n,message:r,data:o}=await(e=t,nf.post("xlive/web-room/v1/index/TrigerInteract",{roomid:e,interact_type:3,csrf:js.BILIJCT,csrf_token:js.BILIJCT,visit_id:""}));if(0===n)return o;oa.info(`ã${t}ãç´æ­é´åäº«å¤±è´¥ ${n} ${r}`)}catch(e){oa.warn(`åäº«ç´æ­é´ [${t}] å¼å¸¸ ${e.message}`)}var e}async function Ul(t){try{const{code:n,message:r,data:o}=await(e=t,nf.post("xlive/web-ucenter/v1/interact/likeInteract",{roomid:e,csrf:js.BILIJCT,csrf_token:js.BILIJCT}));if(0===n)return o;oa.info(`ã${t}ãç´æ­é´ç¹èµå¤±è´¥ ${n} ${r}`)}catch(t){oa.warn(`ç¹èµç´æ­é´å¼å¸¸ ${t.message}`)}var e}async function Bl(t,e){if(!(e.value>=31))try{const{code:n,message:r}=await Pl(t);if(0!==n)return void oa.warn(`ç´æ­é´å¿è·³å¤±è´¥ ${n} ${r}`);e.value++,El.info(`ç´æ­é´å¿è·³æå ${t.uname}ï¼${e.value}/31ï¼`)}catch(t){El.error(t),oa.error(`ç´æ­é´å¿è·³å¼å¸¸ ${t.message}`)}}async function Dl(){const t=(e=await jl())&&0!==e.length?e.filter(Ll):[];var e;return await Promise.allSettled([Nl(t),Fl(t)])}async function Nl(t){for(let e=0;e<t.length;e++){const n=t[e];await Ml(n)}}async function Fl(t){if(0===t.length)return;const{liveHeart:e}=js.intimacy;var n;return e?vi()?await(n=t,Promise.all(n.map((t=>async function(t,e,n){for(let r=0;r<31;r++){const{medal:r,anchor_info:o,room_info:i}=t;await Bl({up_id:r.target_id,room_id:i.room_id,uname:o.nick_name,...e},n),await Us(6e4)}}(t,zl(),{value:0}))))):new Promise((e=>function(t,e){for(const t of e){const e={value:0},r={value:void 0},o=zl();n(t,o,e,r),r.value=setInterval(n,6e4,t,o,e,r),Bs(50,150)}async function n({medal:t,anchor_info:e,room_info:n},r,o,i){await Bl({up_id:t.target_id,room_id:n.room_id,uname:e.nick_name,...r},o),o.value>=31&&i&&i.value&&clearInterval(i.value)}t("ç´æ­é´å¿è·³")}(e,t))):void 0}function zl(){return{buvid:js.buvid,gu_id:zi(43).toLocaleUpperCase(),visit_id:zi(32).toLocaleLowerCase(),uuid:Ai(),click_id:Ai()}}async function Ml(t){const{room_info:e,anchor_info:n}=t;if(!e||!n)return;const{liveLike:r,liveSendMessage:o,liveShare:i}=js.intimacy,a=n.nick_name,s=e.room_id;(r||o||i)&&(o&&(El.verbose(`ã${a}ãå¼å§åéç´æ­å¼¹å¹`),await Al(s,a)),i&&async function(){await Us(100,300);for(let t=0;t<5;t++)El.verbose(`åäº« [${a}] ç´æ­é´`),await Rl(s),await Us(4e3)}().catch((t=>oa.error(t))),r&&async function(){await Us(100,300);for(let t=0;t<3;t++)El.verbose(`ç» [${a}] ç´æ­é´ç¹èµ`),await Ul(s),await Us(6500)}().catch((t=>oa.error(t))),await Us(22e3))}var ql,Jl=Object.freeze({__proto__:null,default:async function(){oa.info("----ãåéç´æ­å¼¹å¹ã----"),oa.info("è¯¥å½æ°å³å°åºå¼ï¼è¯·ä½¿ç¨ liveIntimacy æ¿ä»£");try{const t=await jl(),e=t.length;let n=0,r=0;oa.info(`ä¸å±éè¦åé${e}ä¸ªç´æ­é´`),oa.verbose("æéæ¶é´å¯è½å¾é¿ï¼è¯·èå¿ç­å¾");for(let o=0;o<e;o++){const{room_info:i,anchor_info:a,medal:s}=t[o];null!=i&&i.room_id?100===s.today_feed||s.level>=20?r++:(await Al(i.room_id,a.nick_name)&&n++,o<e-1&&await Us(Ni(1e4,25e3))):(oa.info(`ã${a.nick_name}ãæ²¡æç´æ­é´å¦`),r++)}oa.info(`æååé${n}ä¸ªå¼¹å¹ï¼è·³è¿${r}ä¸ª`)}catch(t){oa.error(`ç´æ­é´åéå¼¹å¹å¼å¸¸: ${t.message}`)}}});async function Gl(){try{const{data:t,message:e,code:n}=await cf();if(0!==n)return void oa.warn(`è·åç¨æ·ä¿¡æ¯å¤±è´¥ï¼${n} ${e}`);!function(t){var e;Ls.bCoinCouponBalance=(null===(e=t.wallet)||void 0===e?void 0:e.coupon_balance)||0}(t)}catch(t){oa.error(`è·åç¨æ·ä¿¡æ¯å¼å¸¸ï¼${t.message}`)}}!function(t){t[t["æå"]=4]="æå",t[t["ä½äº20çµæ± "]=-2]="ä½äº20çµæ± ",t[t["Bå¸ä¸è¶³"]=-4]="Bå¸ä¸è¶³"}(ql||(ql={}));var Kl=Object.freeze({__proto__:null,default:async function(){if(oa.info("----ãç»ç®æ åçµã----"),await Gl(),await Us(),function(){const t=Ri(),e=t.getDate(),n=Li(t);let r=js.charge.presetTime;return xi(r)||(r=[r]),Ls.bCoinCouponBalance<2?(oa.info(`å©ä½å¸ä¸º${Ls.bCoinCouponBalance}ï¼ä¸è¶³2è·³è¿åçµ`),!1):n===e?(oa.info("ä»å¤©æ¯æåä¸å¤©äº"),!0):!!r.some((t=>t===e))||(oa.info("ä¸å¨é¢è®¾æ¶é´ï¼ä¸ç¬¦åæ¡ä»¶"),!1)}())try{const t=Ls.bCoinCouponBalance||0,e=js.charge.mid;let n=0;oa.info(`b å¸å¸ä½é¢${t}`);const r=async()=>{const{code:n,message:r,data:o}=await function(t=50,e=!0,n=js.USERID,r="up",o=n){return rf.post("/x/ugcpay/web/v2/trade/elec/pay/quick",{csrf:js.BILIJCT,bp_num:t,is_bp_remains_prior:e,up_mid:n,otype:r,oid:o})}(t,!0,e);0===n?(oa.info(`ç®æ ã${e}ã${ql[o.status]}`),o.status===ql["æå"]&&(Ls.chargeOrderNo=o.order_no,await Us(),await async function(){try{if(!Ls.chargeOrderNo)return!1;const t=_i[Ni(0,_i.length-1)],{code:e}=await function(t,e="æ¯æå¤§ä½¬ä¸æ³¢"){return rf.post("/x/ugcpay/trade/elec/message",{csrf:js.BILIJCT,message:e,order_id:t})}(Ls.chargeOrderNo,t);0===e&&oa.info("çè¨æåï¼")}catch{}}())):oa.warn(`åçµå¤±è´¥ï¼${n} ${r}`)};for(Ls.chargeOrderNo="";!(Ls.chargeOrderNo||(await r(),await Us(),n++>2)););}catch(t){oa.error(`åçµåºç°å¼å¸¸ï¼${t.message}`)}}});async function Wl(){try{const{data:t,code:e,message:n}=await rf.get("/x/vip/privilege/my",{headers:{origin:fs,referer:ms}});if(0!==e)return void oa.info(`è·åé¢åç¶æå¤±è´¥ï¼${e} ${n}`);const{list:r}=t,o=r.filter((t=>0===t.state));return 0===o.length?void oa.info("ææ å¯é¢åæçï¼å·²é¢åï¼"):o}catch(t){oa.error(`è·åé¢åç¶æåºç°å¼å¸¸ï¼${t.message}`)}}async function Hl(t){try{const e=function(t){switch(t){case 1:return"B å¸å¸";case 2:return"ä¼åè´­ä¼æ å¸";case 3:return"æ¼«è¯»å¸";case 4:return"ä¼åè´­è¿è´¹å¸";default:return"æªç¥"}}(t),{code:n,message:r}=await function(t=1){return rf.post("/x/vip/privilege/receive",{csrf:js.BILIJCT,type:t},{headers:{origin:gs,referer:ms}})}(t);let o="æå";return 0!==n&&(o=`å¤±è´¥ ${r}`),oa.info(`é¢å${e}${o}`),!0}catch(t){oa.error(`é¢åæçåºç°å¼å¸¸ï¼${t.message}`),oa.error(t)}return!1}async function Ql(t){if(![1,3].includes(t))return;let e=0,n=!1;for(;!(n||(n=await Hl(t),e>2));)e++;return n}var Yl=Object.freeze({__proto__:null,default:async function(){try{if(oa.info("----ãé¢åå¤§ä¼åæçã----"),0===Ls.vipStatus||0===Ls.vipType)return void oa.info("æ¨è¿ä¸æ¯å¤§ä¼åï¼æ æ³é¢åæç");const t=await Wl();if(!t||0===t.length)return;for(let e=0;e<t.length;e++){await Us(100);const n=t[e];await Ql(n.type)}}catch(t){oa.error(`é¢åå¤§ä¼åæçåºç°å¼å¸¸ï¼${t.message}`),oa.error(t)}}});function Vl(t,e,n,r){const o=js.BILIJCT,i={is_fav:0,main_id:e,oid:t,detail_id:n,count:r,csrf:o,csrf_token:o};return rf.post("/x/esports/guess/add",i)}function Xl(){const{coin:t,match:e}=js;return Ls.money-e.coins<t.stayCoins&&(oa.info(`éè¦ä¿ç${t.stayCoins}ä¸ªç¡¬å¸ï¼ä»»å¡ç»æ`),!0)}var Zl=Object.freeze({__proto__:null,default:async function(){oa.info("----ãèµäºç¡¬å¸ç«çã----");const{match:t}=js;if(t.coins<=0)return void oa.info("ç¡¬å¸æ°éä¸è½å°äº 0");if(Xl())return;const e=await async function(){try{const{code:t,message:e,data:{list:n,page:r}}=await function(t="",e=""){return rf.get(`/x/esports/guess/collection/question?pn=1&ps=50&gid=&sids=&stime=${t}&etime=${e}`)}();return 0!==t?void oa.warn(`è·åèµäºéè¯¯ ${t} ${e}`):0===r.total?(oa.info("ä»æ¥å·²ç»æ æ³è·åèµäº"),null):n}catch(t){oa.debug(t.message)}}();if(await Us(),!e)return;const n=await async function(t){let e=0;try{for(const n of t){const{contest:t,questions:r}=n,o=t.id,[{id:i,title:a,details:s,is_guess:c}]=r,[u,f]=s;if(Xl())return e;if(c)continue;oa.info(`${a} <=> ${u.odds}:${f.odds}`);const l=u.odds>f.odds,{match:d}=js;let p;p=d.selection>0?l?f:u:l?u:f,oa.info(`é¢æµ[ ${p.option} ] ${d.coins} é¢ç¡¬å¸`),await Us();const{code:g}=await Vl(o,i,p.detail_id,d.coins);0!==g?oa.info("é¢æµå¤±è´¥"):(e++,Ls.money-=d.coins)}}catch(t){console.warn(t.message)}return e}(function(t,e){return t.filter((t=>{const{questions:n}=t,[{details:r,is_guess:o}]=n;if(o)return!1;const[i,a]=r;return Math.abs(i.odds-a.odds)>=e}))}(e,t.diff));oa.info(`ãç«çç»æãä¸å±åä¸${n}æ¬¡é¢æµ`)}});const td=new na({console:"debug",file:"warn",push:"warn"},"live");async function ed(){const{data:t,code:e}=await ff(1,1,0);if(0!==e)throw new Error(`è·åæåä¸ä¸ªå³æ³¨å¤±è´¥: ${e}`);return t[0]}async function nd(t){const{data:e,code:n}=await rf.get("x/relation/tags?jsonp=jsonp&callback=__jp3",{headers:{Referer:"https://space.bilibili.com/1/fans/follow?tagid=0"},requestOptions:{isJsonp:!0}});if(0===n)return e.find((e=>e.name===t));oa.warn(`è·ååç»åè¡¨å¤±è´¥: ${n}`)}async function rd(t){const e=await nd(t);if(e)return e.tagid;await Us(300);const{data:n,code:r,message:o}=await(i=t,rf.post("x/relation/tag/create",{tag:i,jsonp:"jsonp",csrf:js.BILIJCT}));var i;if(22106===r){await Us(300);const e=await nd(t);return e&&e.tagid}return 0!==r&&oa.warn(`åå»ºåç»å¤±è´¥: ${r}-${o}`),n.tagid}async function od(t,e="å¤©éæ¶å»"){if(0===t.length)return;const n=await rd(e);if(n)for(const e of t){const{code:t,message:r}=await df(e.mid,n);0!==t&&oa.warn(`ç§»å¨ã${e.uname}ãå¤±è´¥: ${t}-${r}`),await Us(500,1300)}}async function id(t="å¤©éæ¶å»",e=-1){const n=await nd(t);if(n&&(await Us(),n.tagid))try{const{data:r,code:o}=await ff(1,20,n.tagid);if(0!==o||!r.length)return;if(e=await async function(t,e=-1){for(const n of t){if(0===e)return e;try{const{code:t,message:r}=await lf(n.mid);td.info(`åå³ã${n.uname}ãæåï¼`),0!==t&&oa.warn(`åå³ã${n.uname}ãå¤±è´¥: ${t}-${r}`),-1!==e&&e--,await Us(1500)}catch(t){oa.warn(`åå³ã${n.uname}ãå¼å¸¸: ${t.message}`)}}return e}(r,e),r.length<20)return;0!==e&&await id(t,e)}catch(t){oa.warn(`åå³åç»å¼å¸¸: ${t.message}`)}}async function ad(t,e,n,r=1){if(t.length>e.length)return;const{data:o,code:i,message:a}=await ff(r,20,0);if(0===i){for(const{mid:r,uname:i}of o){if(t.length>=e.length)return;if(r===n)return;(e.includes(r)||e.includes(i))&&t.push({mid:r,uname:i})}if(!(o.length<20))return await ad(t,e,n,r+1)}else oa.warn(`è·åå³æ³¨ç¨æ·å¤±è´¥: ${i}-${a}`)}var sd=Object.freeze({__proto__:null,default:async function(){oa.info("----ãæ¹éåå³ã----");try{await id(js.lottery.moveTag),oa.info("æ¹éåå³å®æ")}catch(t){oa.error(`æ¹éåå³: ${t.message}`)}}});const cd=0,ud=1,fd=5,ld=1,dd=504,pd=1096;let gd;async function md(){try{const{data:t,code:e,message:n}=await nf.get("/xlive/web-interface/v1/index/getWebAreaList?source_id=2");return 0!==e&&oa.info(`è·åç´æ­ååºå¤±è´¥: ${e}-${n}`),t.data.map((t=>t.list)).map((t=>t.map((t=>({areaId:t.id,parentId:t.parent_id})))))}catch(t){throw oa.error(`è·åç´æ­ååºå¼å¸¸: ${t.message}`),t}}async function hd(t,e,n=1,r="lottery"){try{await Us(100);const{data:o,code:i,message:a}=await function(t,e,n=1){return nf.get(`/xlive/web-interface/v1/second/getList?platform=web&parent_area_id=${t}&area_id=${e}&page=${n}`)}(e,t,n);return 0!==i&&oa.info(`è·åç´æ­é´åè¡¨å¤±è´¥: ${i}-${a}`),function(t){const e=[],n=[];return t.forEach((t=>{const r=t.pendant_info[2];r&&(r.pendent_id===dd?e.push(t):r.pendent_id===pd&&n.push(t))})),{lotteryTime:e,lotteryPacket:n}}(o.list)["lottery"===r?"lotteryTime":"lotteryPacket"]}catch(t){throw oa.error(`è·åç´æ­é´åè¡¨å¼å¸¸: ${t.message}`),t}}async function yd(t,e,n=1){const r=await hd(t,e,n),o=[];for(const t of r){const e=await vd(t);e&&(o.push({...e,uid:t.uid,uname:t.uname}),await Us(100))}return o}async function vd(t){const{blackUid:e}=js.lottery;if(e.includes(t.uid))return void oa.info(`è·³è¿é»ååç¨æ·: ${t.uname}`);let n,r,o;try{({data:r,code:n,message:o}=await jf(t.roomid))}catch(e){return void oa.info(`ç´æ­é´${t.roomid}æ£æµå¼å¸¸: ${e.message}`)}if(0!==n)return void oa.debug(`ç´æ­é´${t.roomid}æ£æµå¤±è´¥: ${n}-${o}`);if(null===r)return;const{excludeAward:i,includeAward:a}=js.lottery,s=i.some((t=>r.award_name.match(t)));if(a.some((t=>r.award_name.match(t)))||!s){if(r.status===ld&&!(r.gift_price>0))return 4===r.require_type&&(oa.info("æ¨è½åé¦ç»ä½èè¾åºäºä»ä¹åï¼"),oa.info(`${r.require_type}--${r.require_text}--${r.require_value}`),oa.info("ä¹è®¸è¿æ­£æ¯æä»¬æ³è¦çã")),r.require_type===fd&&Ls.userLevel>=r.require_value||r.require_type===cd?r:r.require_type!==ud||js.lottery.skipNeedFollow?void 0:r}else oa.info(`è·³è¿å±è½å¥å: ${r.award_name}`)}async function _d(t,e=!0){try{const{id:r,gift_id:o,gift_num:i,award_name:a,uid:s,uname:c,require_type:u,require_text:f}=t;oa.info(`å¤©éä¸»æ­ï¼ã${c}ã`),oa.info(`å¥åï¼${a}`);const{code:l,message:d}=await(n={id:r,gift_id:o,gift_num:i},nf.post("/xlive/lottery-interface/v1/Anchor/Join",{...n,csrf:js.BILIJCT,csrf_token:js.BILIJCT,visit_id:Mi(),platform:"pc"}));if(0!==l)return void oa.info(`å¤©éå¤±è´¥: ${l}-${d}`);if(oa.info("å¤©éæå â"),u===ud&&e){qi(gd,s);(function(t){const e=(t=t.replace("å³æ³¨ä¸»æ­","")).split(/\s*\+\s*/);return e.shift(),e})(f).forEach((t=>qi(gd,t)))}}catch(t){oa.info(`å¤©éå¼å¸¸: ${t.message}`)}var n}async function wd(t,e,n=2){for(let r=1;r<=n;r++){const n=await yd(t,e,r);for(const t of n)await _d(t),await Us(300)}}async function bd(t){try{const{data:e,code:n}=await function(t){return nf.get(`/xlive/lottery-interface/v1/lottery/getLotteryInfoWeb?roomid=${t}`)}(t);if(0!==n)return;const{popularity_red_pocket:r}=e;if(!r)return;const{lot_id:o,lot_status:i}=r[0];if(2===i)return;return o}catch(t){oa.debug(`æ£æµçº¢åå¼å¸¸: ${t.message}`)}}async function $d(t,e,n=1){const r=await hd(t,e,n,"redPack"),o=[];for(const t of r){const e=await bd(t.roomid);e&&(o.push({uid:t.uid,uname:t.uname,lot_id:e,room_id:t.roomid}),await Us(100))}return o}async function Td(t){try{const{lot_id:n,uid:r,uname:o,room_id:i}=t;oa.info(`çº¢åä¸»æ­ï¼ã${o}ã`);const{code:a,message:s}=await(e={room_id:i,lot_id:n,ruid:r},nf.post("/xlive/lottery-interface/v1/popularityRedPocket/RedPocketDraw",{...e,spm_id:"444.8.red_envelope.extract",jump_from:"",session_id:"",csrf_token:js.BILIJCT,csrf:js.BILIJCT,visit_id:""}));if(0!==a)return void oa.info(`çº¢åå¤±è´¥: ${a}-${s}`);gd.push(r),oa.info("çº¢åæå â")}catch(t){oa.info(`çº¢åå¼å¸¸: ${t.message}`)}var e}async function Sd(t,e,n=2){for(let r=1;r<=n;r++){const n=await $d(t,e,r);for(const t of n)await Pl({room_id:t.room_id,up_id:t.uid}),await Us(100),await Td(t),await Us(400)}}async function Od(){const t=[];return await async function e(n=1){try{var r;const{data:o,code:i,message:a}=await function(t=1,e=9){return nf.get(`/xlive/web-ucenter/user/following?page=${t}&page_size=${e}`)}(n,9);if(0!==i)return void oa.info(`è·åå³æ³¨ç´æ­é´å¤±è´¥: ${i}-${a}`);const s=null===(r=o.list)||void 0===r?void 0:r.filter((t=>1===t.live_status));if(9===s.length&&n<o.totalPage)return t.push(...s),e(n+1);t.push(...s)}catch(t){oa.error(`è·åå³æ³¨ç´æ­é´å¼å¸¸: ${t.message}`)}}(),t}async function kd(t){try{const{code:e,message:n,data:r}=await jf(t.roomid);if(0!==e)return void oa.debug(`ç´æ­é´${t.roomid}æ£æµå¤±è´¥: ${e}-${n}`);if(null===r)return;if(r.status!==ld)return;if(r.gift_price>0)return;return r}catch(e){return void oa.info(`ç´æ­é´${t.roomid}æ£æµå¼å¸¸: ${e.message}`)}}async function Cd(){const{scanFollow:t}=js.lottery;if(!t)return!0;try{oa.info("å¼å§æ«æå³æ³¨çä¸»æ­");const t=await async function(){const t=await Od(),e=[];for(const n of t){const t=await kd(n);t&&e.push({...t,uid:n.uid,uname:n.uname}),await Us(100)}return e}();for(const e of t)await _d(e,!1),await Us(300);oa.info("å³æ³¨çä¸»æ­å¤©éå®æ")}catch(t){oa.error(`å³æ³¨çä¸»æ­å¤©éå¼å¸¸: ${t.message}`)}return"only"!==t}async function Id(){oa.info("----ãå¤©éæ¶å»ã----");const t=await Cd();if(!t)return t;try{const t=await ed();oa.info(`æåä¸ä¸ªå³æ³¨çUP: ${t.uname}`);const e=await async function(){gd=[];const{pageNum:t}=js.lottery,e=await md();for(const n of e)for(const e of n)await wd(e.areaId,e.parentId,t);return gd}();oa.info("æ«æå®æ");const n=[];await ad(n,e,null==t?void 0:t.mid),js.lottery.isMoveTag&&(await od(n,js.lottery.moveTag),oa.info("ç§»å¨å³æ³¨UPå°åç»æå"))}catch(t){oa.warn(`å¤©éæ¶å»å¼å¸¸: ${t.message}`),oa.debug(t)}oa.info("ç»æå¤©éæ¶å»")}var Pd=Object.freeze({__proto__:null,default:Id,liveLottery:Id});async function xd(t){try{const{code:e,message:n,data:r}=await function({session_type:t}={session_type:1}){return af.get(`/session_svr/v1/session_svr/get_sessions?session_type=${t}&group_fold=1&unfollow_fold=1&sort_rule=2&build=0&mobi_app=web`)}();if(0!==e)return void oa.warn(`è·åä¼è¯å¤±è´¥ï¼${e}-${n}`);const{session_list:o}=r;if(o.length<=0)return;return o.filter((({unread_count:e,talker_id:n,is_follow:r,last_msg:o})=>{return t.find((t=>t.mid===n))&&e>0&&n===o.sender_uid&&1===r&&(i=o.timestamp,Date.now()-1e3*i<36e5);var i}))}catch(t){oa.error(`è·åä¼è¯å¼å¸¸ï¼${t.message}`)}}async function Ed(t){const e=await xd(t);await Us(200);try{for(let t=0;t<e.length;t++){const n=e[t];await jd(n)}}catch(t){oa.error(`æ´æ°ä¼è¯å¼å¸¸ï¼${t.message}`)}e.length>=19&&await Ed(t)}async function jd(t){switch(js.lottery.actFollowMsg){case"del":case"delete":await function({talker_id:t,session_type:e}){return af.post("/session_svr/v1/session_svr/remove_session",{talker_id:t,session_type:e,build:0,mobi_app:"web",csrf_token:js.BILIJCT,csrf:js.BILIJCT})}(t);break;case"read":await function({talker_id:t,session_type:e,ack_seqno:n}){return af.post("/session_svr/v1/session_svr/update_ack",{talker_id:t,session_type:e,ack_seqno:n,build:0,mobi_app:"web",csrf_token:js.BILIJCT,csrf:js.BILIJCT},{headers:{origin:ps}})}(t)}await Us(50)}async function Ld(){oa.info("----ãå¤©éçº¢åã----");try{const t=await ed();oa.info(`æåä¸ä¸ªå³æ³¨çUP: ${t.uname}`);const e=await async function(){gd=[];const{pageNum:t}=js.lottery,e=await md();for(const n of e)for(const e of n)await Sd(e.areaId,e.parentId,t);return gd}();oa.info("æ«æå®æï¼è·åæ°å³æ³¨çUP");const n=[];await ad(n,e,null==t?void 0:t.mid),oa.info("å¼å§è¯»åæ¶æ¯"),await Ed(n),js.lottery.isMoveTag&&(oa.info("ç§»å¨å³æ³¨UPå°åç»"),await od(n,js.lottery.moveTag),oa.info("ç§»å¨å³æ³¨UPå°åç»æå"))}catch(t){oa.warn(`å¤©éæ¶å»å¼å¸¸: ${t.message}`),oa.debug(t)}oa.info("ç»æå¤©éçº¢å")}var Ad=Object.freeze({__proto__:null,default:Ld,liveRedPack:Ld});var Rd=Object.freeze({__proto__:null,default:async function(){oa.info("----ãç´æ­äº²å¯åº¦ã----");try{await Dl(),oa.info("ç´æ­äº²å¯åº¦å®æ")}catch(t){oa.error(`ç´æ­äº²å¯åº¦: ${t.message}`)}}});let Ud=0;async function Bd(){try{const{data:{list:t}}=await function(t=3394945){const e=(new Date).getTime();return nf.get(`/xlive/web-room/v1/gift/bag_list?t=${e}&room_id=${t}`)}();if(!t)return;return t.filter((t=>{if(t.expire_at<=0)return!1;const e=(1e3*t.expire_at-(new Date).getTime())/864e5<2,n=![1,30607,30426,31531].includes(t.gift_id);return n&&e&&oa.info(`${t.gift_name} å³å°è¿æè¯·å°½å¿«æå`),!n&&e}))}catch(t){if(Ud++)return null;await Bd()}}async function Dd(t){try{const{data:{live_room:e,name:n}}=await function(t){return rf.get(`x/space/acc/info?mid=${t}&jsonp=jsonp`)}(t);if(await Us(),e.roomStatus)return{roomid:e.roomid,name:n}}catch{}}var Nd=Object.freeze({__proto__:null,default:async function(){oa.info("----ãæåè¿æé£ç©ã----");try{const t=await Bd();if(await Us(),null==t||!t.length)return void oa.info("æ²¡æ2å¤©åè¿æçç®åç¤¼ç©");const e=await async function(){const{gift:t}=js,e=t.mids||[],n=()=>e.splice(Ni(e.length-1),1)[0];for(;e.length;){const t=n(),e=await Dd(t);if(e)return{mid:t,...e}}return await async function(){const{data:{count:t,items:e}}=await function(t=1,e=10){return t>10&&(t=10),nf.get(`/xlive/app-ucenter/v1/user/GetMyMedals?page=${t}&page_size=${e}`)}();if(await Us(),!t)return;const n=e[Ni(e.length-1)];return{mid:n.target_id,roomid:n.roomid||0,name:n.uname}}()}();if(!e)return void oa.info("æ²¡ææ¾å°æåç®æ ");await async function({roomid:t,mid:e,name:n},r){for(const o of r){await Us();try{const{code:r,message:i,data:a}=await Ef({roomid:t,ruid:e,bag_id:o.bag_id,gift_id:o.gift_id,gift_num:o.gift_num});if(0!==r){oa.warn(`å[${n}]æå[${o.gift_name}]ï¼${i}`);continue}a.gift_list.forEach((t=>{oa.info(`æåç» [${n}] æå${t.gift_name}`)}))}catch{oa.debug(`å[${n}]æå[${o.gift_name}]ï¼å¼å¸¸`)}}}(e,t)}catch(t){oa.info(`æåè¿æé£ç©å¼å¸¸ ${t}`)}}});async function Fd(t,e={},...n){const r=void 0===(o=e.logger)?oa:Pi(o)?o?oa:ra:o;var o;const{name:i,successCode:a=0}=e;try{const{code:e,message:o,msg:s,data:c}=await t(...n);return e!==a?void r.warn(`${i||t.name}è¯·æ±å¤±è´¥ï¼${e} ${o||s}`):c}catch(e){r.error(`${i||t.name}è¯·æ±åºç°å¼å¸¸`),r.error(e)}}function zd(t){const e=t.level_info,n=e.current_level;if(n>=js.coin.targetLevel&&(Ls.coinsTask=0),oa.info(`å½åç­çº§: ${e.current_level}`),n>=6){const t=js.function;t.shareAndWatch=!1,t.addCoins=!1,t.taskReward=!1,oa.info("å·²ç»æ»¡çº§ï¼ä¸éè¦åæå¸äºï¼åä¸ªç½å«æªå§")}else{const t=e.next_exp-e.current_exp;oa.info(`è·ç¦»åçº§è¿éè¦ ${t} ç»éªï¼é¢è®¡ ${function(t){const{targetCoins:e}=js.coin;if(e<=0)return t/15;const n=10*e+15,r=t/n,o=Ls.money/(e-1);return r<o?Math.floor(r):(t-o*n)/25+o}(t).toFixed(2)} å¤©`)}}function Md(t){let e="";switch(Ls.vipType=t.vipType,Ls.vipStatus=t.vipStatus,t.vipType){case 0:e="æ å¤§ä¼å";break;case 1:e="æåº¦å¤§ä¼å";break;case 2:e="å¹´åº¦å¤§ä¼å"}0===t.vipStatus&&(e="æ å¤§ä¼å"===e?e:e+"[å·²è¿æ]"),oa.info(`å¤§ä¼åç¶æ: ${e}`)}var qd=Object.freeze({__proto__:null,setVipStatus:Md,default:async function(){oa.info("----ãç»å½ã----");const{data:t,message:e,code:n}=await cf();if(0!==n)throw oa.error(`ç»å½éè¯¯ ${n} ${e}`),new Error(e);if(!t.isLogin)throw new Error("æ¥å£è¿åä¸ºæªç»å½");await Us(),await async function(t){try{var e;const{money:n}=await Fd(uf);oa.info(`ç»å½æå: ${t.uname}`),oa.info(`ç¡¬å¸ä½é¢: ${n||0}`),Ls.nickname=t.uname,Ls.money=n||0,Ls.userLevel=t.level_info.current_level,Ls.bCoinCouponBalance=(null===(e=t.wallet)||void 0===e?void 0:e.coupon_balance)||0,zd(t),Md(t)}catch(t){oa.error(`è·åç¡¬å¸ä¿¡æ¯å¼å¸¸: ${t.message}`),oa.debug(t)}}(t)}});const Jd=new na({console:"debug",file:"warn",push:"warn",payload:Ls.nickname},"live");async function Gd(){const t=await async function(){try{const{data:t,code:e,message:n}=await nf.get(`activity_php/v1/Famine/recommendAnchors?_=${(new Date).getTime()}`);return 0!==e?void Jd.warn(`è·åæ´»å¨ä¸»æ­å¤±è´¥ ${e} ${n}`):t.anchor_list}catch(t){Jd.error(t),Jd.error(`è·åæ´»å¨çä¸»æ­å¼å¸¸ ${t.message}`)}}();if(!t||0===t.length)return;const e=Hi(t);Jd.info(`è·åå°ä¸»æ­ï¼${e.nickname} æ¿é´å·ï¼${e.room_id}`);const n=zl();await async function(t,e){for(let n=e;n>0;n--)await Kd(t),await Us(6e4)}({up_id:e.uid,room_id:e.room_id,...n},10)}async function Kd(t){try{const{code:e,message:n}=await Pl(t);if(0!==e)return void Jd.warn(`ç´æ­é´å¿è·³å¤±è´¥ ${e} ${n}`);Jd.info("ç´æ­é´å¿è·³æå")}catch(t){Jd.error(t),Jd.error(`ç´æ­é´å¿è·³å¼å¸¸ ${t.message}`)}}async function Wd(){try{const{data:t,code:e,message:n}=await nf.get(`activity_php/v1/Famine/userWatchTime?_=${(new Date).getTime()}`);return 0!==e?void Jd.warn(`è·åè§çæ¶é´å¤±è´¥ ${e} ${n}`):t}catch(t){Jd.error(t),Jd.error(`è·åè§çæ¶é´å¤±è´¥ ${t.message}`)}}var Hd=Object.freeze({__proto__:null,default:async function(){oa.info("----ãé¥¥èç´æ­é´ææºã----");try{await async function(t=400){for(let e=t/6;e>0&&!((await Wd()).duration>360);e--)await Gd()}(js.activity.liveFamineTime),oa.info("é¥¥èç´æ­é´ææºå®æ")}catch(t){oa.error(`é¥¥èç´æ­é´ææº: ${t.message}`)}}});
